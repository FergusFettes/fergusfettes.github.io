<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.237">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Fergus Fettes">

<title>Fergus Fettes - GIS Map Experiments</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<style>
    .quarto-title-block .quarto-title-banner {
      color: white;
background: pink;
    }
    </style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Fergus Fettes</span>
    </a>
  </div>
          <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-reviews" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Reviews</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-reviews">    
        <li class="dropdown-header">Cities</li>
        <li>
    <a class="dropdown-item" href="../../Reviews/Cities.html">
 <span class="dropdown-text">City Reviews</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <div class="quarto-toggle-container">
                <a href="" class="quarto-reader-toggle nav-link" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
            </div>
            <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <div class="quarto-title-block"><div><h1 class="title">GIS Map Experiments</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Fergus Fettes </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">Oct 30, 2022</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#attempt-1-to-make-running-routes-from-text" id="toc-attempt-1-to-make-running-routes-from-text" class="nav-link active" data-scroll-target="#attempt-1-to-make-running-routes-from-text">Attempt 1 to make running routes from text</a>
  <ul class="collapse">
  <li><a href="#convert-text-to-gps-coords" id="toc-convert-text-to-gps-coords" class="nav-link" data-scroll-target="#convert-text-to-gps-coords">Convert Text to GPS Coords</a></li>
  <li><a href="#make-it-a-linestring" id="toc-make-it-a-linestring" class="nav-link" data-scroll-target="#make-it-a-linestring">Make it a linestring</a></li>
  <li><a href="#simplify-the-linestring" id="toc-simplify-the-linestring" class="nav-link" data-scroll-target="#simplify-the-linestring">Simplify the linestring</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block page-columns page-full" id="quarto-document-content">




<section id="attempt-1-to-make-running-routes-from-text" class="level1 page-columns page-full">
<h1>Attempt 1 to make running routes from text</h1>
<p><a href="../../Projects/GIS.html">Main</a></p>
<section id="convert-text-to-gps-coords" class="level2">
<h2 class="anchored" data-anchor-id="convert-text-to-gps-coords">Convert Text to GPS Coords</h2>
<div class="cell" data-execution_count="1">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an svg of the word 'test'</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> svgwrite</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>dwg <span class="op">=</span> svgwrite.Drawing(<span class="st">'test.svg'</span>, profile<span class="op">=</span><span class="st">'tiny'</span>, size<span class="op">=</span>(<span class="st">'60mm'</span>, <span class="st">'23mm'</span>))</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Add the word 'test' in black</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>dwg.add(dwg.text(<span class="st">'test'</span>, insert<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">80</span>), fill<span class="op">=</span><span class="st">'black'</span>, font_size<span class="op">=</span><span class="dv">100</span>))</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>dwg.save()</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the svg to a png</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> cairosvg</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>cairosvg.svg2png(url<span class="op">=</span><span class="st">'test.svg'</span>, write_to<span class="op">=</span><span class="st">'test.png'</span>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the png</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> Image</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>Image(filename<span class="op">=</span><span class="st">'test.png'</span>)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the png to a geojson</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pyvips</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pyproj</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> shapely.geometry</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the png</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>image <span class="op">=</span> pyvips.Image.new_from_file(<span class="st">'test.png'</span>, access<span class="op">=</span><span class="st">'sequential'</span>)</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the png to a numpy array</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>image <span class="op">=</span> np.array(image)</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the width and height of the image</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>width <span class="op">=</span> image.shape[<span class="dv">1</span>]</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>height <span class="op">=</span> image.shape[<span class="dv">0</span>]</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the x and y coordinates of the pixels</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>x, y <span class="op">=</span> np.meshgrid(np.arange(width), np.arange(height))</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the red, green and blue values of the pixels</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> image[:, :, <span class="dv">0</span>]</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> image[:, :, <span class="dv">1</span>]</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> image[:, :, <span class="dv">2</span>]</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the alpha values of the pixels</span></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> image[:, :, <span class="dv">3</span>]</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the x and y coordinates of the pixels that are not transparent</span></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> x[a <span class="op">&gt;</span> <span class="dv">0</span>]</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> y[a <span class="op">&gt;</span> <span class="dv">0</span>]</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Center the x and y coordinates on Prague</span></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>prague <span class="op">=</span> (<span class="fl">14.4378</span>, <span class="fl">50.0755</span>)</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the ratio of the width and height of the image</span></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>ratio <span class="op">=</span> width <span class="op">/</span> height</span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a><span class="co"># The final height will be 500 meters</span></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>final_height <span class="op">=</span> <span class="dv">500</span></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>final_width <span class="op">=</span> final_height <span class="op">*</span> ratio</span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the width and height</span></span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(final_width, final_height)</span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a><span class="co"># Meters to degrees</span></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>meters_to_degrees <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> <span class="dv">111111</span></span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a><span class="co"># Degree range</span></span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>degree_height <span class="op">=</span> final_height <span class="op">*</span> meters_to_degrees</span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>degree_width <span class="op">=</span> final_width <span class="op">*</span> meters_to_degrees</span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the x and y coordinates of the pixels to lat and lon</span></span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>lat <span class="op">=</span> np.interp(y, [<span class="dv">0</span>, height], [prague[<span class="dv">1</span>] <span class="op">+</span> degree_height <span class="op">/</span> <span class="dv">2</span>, prague[<span class="dv">1</span>] <span class="op">-</span> degree_height <span class="op">/</span> <span class="dv">2</span>])</span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>lon <span class="op">=</span> np.interp(x, [<span class="dv">0</span>, width], [prague[<span class="dv">0</span>] <span class="op">-</span> degree_width <span class="op">/</span> <span class="dv">2</span>, prague[<span class="dv">0</span>] <span class="op">+</span> degree_width <span class="op">/</span> <span class="dv">2</span>])</span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a><span class="co"># Decimate the image by a factor of 10</span></span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>lat <span class="op">=</span> lat[::<span class="dv">10</span>]</span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a>lon <span class="op">=</span> lon[::<span class="dv">10</span>]</span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the lat and lon to a geojson</span></span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a>points <span class="op">=</span> []</span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(lat)):</span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>    points.append(shapely.geometry.Point(lon[i], lat[i]))</span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>feature <span class="op">=</span> shapely.geometry.MultiPoint(points)</span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the geojson</span></span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> folium</span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> folium.Map(location<span class="op">=</span>[prague[<span class="dv">1</span>], prague[<span class="dv">0</span>]], zoom_start<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>folium.GeoJson(feature).add_to(m)</span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>m</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>1313.9534883720928 500</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="4">
<div style="width:100%;"><div style="position:relative;width:100%;height:0;padding-bottom:60%;"><span style="color:#565656">Make this Notebook Trusted to load map: File -&gt; Trust Notebook</span><iframe srcdoc="<!DOCTYPE html>
<head>    
    <meta http-equiv=&quot;content-type&quot; content=&quot;text/html; charset=UTF-8&quot; />
    
        <script>
            L_NO_TOUCH = false;
            L_DISABLE_3D = false;
        </script>
    
    <style>html, body {width: 100%;height: 100%;margin: 0;padding: 0;}</style>
    <style>#map {position:absolute;top:0;bottom:0;right:0;left:0;}</style>
    <script src=&quot;https://cdn.jsdelivr.net/npm/leaflet@1.6.0/dist/leaflet.js&quot;></script>
    <script src=&quot;https://code.jquery.com/jquery-1.12.4.min.js&quot;></script>
    <script src=&quot;https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js&quot;></script>
    <script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.js&quot;></script>
    <link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/npm/leaflet@1.6.0/dist/leaflet.css&quot;/>
    <link rel=&quot;stylesheet&quot; href=&quot;https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css&quot;/>
    <link rel=&quot;stylesheet&quot; href=&quot;https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap-theme.min.css&quot;/>
    <link rel=&quot;stylesheet&quot; href=&quot;https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css&quot;/>
    <link rel=&quot;stylesheet&quot; href=&quot;https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.css&quot;/>
    <link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/gh/python-visualization/folium/folium/templates/leaflet.awesome.rotate.min.css&quot;/>
    
            <meta name=&quot;viewport&quot; content=&quot;width=device-width,
                initial-scale=1.0, maximum-scale=1.0, user-scalable=no&quot; />
            <style>
                #map_8709a535270fefc95723f6ac6550e360 {
                    position: relative;
                    width: 100.0%;
                    height: 100.0%;
                    left: 0.0%;
                    top: 0.0%;
                }
            </style>
        
</head>
<body>    
    
            <div class=&quot;folium-map&quot; id=&quot;map_8709a535270fefc95723f6ac6550e360&quot; ></div>
        
</body>
<script>    
    
            var map_8709a535270fefc95723f6ac6550e360 = L.map(
                &quot;map_8709a535270fefc95723f6ac6550e360&quot;,
                {
                    center: [50.0755, 14.4378],
                    crs: L.CRS.EPSG3857,
                    zoom: 15,
                    zoomControl: true,
                    preferCanvas: false,
                }
            );

            

        
    
            var tile_layer_f63df26a1d62d2fc2ba0eac0a24a3a01 = L.tileLayer(
                &quot;https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png&quot;,
                {&quot;attribution&quot;: &quot;Data by \u0026copy; \u003ca href=\&quot;http://openstreetmap.org\&quot;\u003eOpenStreetMap\u003c/a\u003e, under \u003ca href=\&quot;http://www.openstreetmap.org/copyright\&quot;\u003eODbL\u003c/a\u003e.&quot;, &quot;detectRetina&quot;: false, &quot;maxNativeZoom&quot;: 18, &quot;maxZoom&quot;: 18, &quot;minZoom&quot;: 0, &quot;noWrap&quot;: false, &quot;opacity&quot;: 1, &quot;subdomains&quot;: &quot;abc&quot;, &quot;tms&quot;: false}
            ).addTo(map_8709a535270fefc95723f6ac6550e360);
        
    

        function geo_json_91dd001dff7b0f234925a5e7742a29e4_onEachFeature(feature, layer) {
            layer.on({
            });
        };
        var geo_json_91dd001dff7b0f234925a5e7742a29e4 = L.geoJson(null, {
                onEachFeature: geo_json_91dd001dff7b0f234925a5e7742a29e4_onEachFeature,
            
        });

        function geo_json_91dd001dff7b0f234925a5e7742a29e4_add (data) {
            geo_json_91dd001dff7b0f234925a5e7742a29e4
                .addData(data)
                .addTo(map_8709a535270fefc95723f6ac6550e360);
        }
            geo_json_91dd001dff7b0f234925a5e7742a29e4_add({&quot;coordinates&quot;: [[14.432358134093018, 50.07722674591279], [14.440363956052327, 50.07722674591279], [14.432358134093018, 50.07717442027907], [14.440363956052327, 50.07717442027907], [14.432358134093018, 50.07712209464535], [14.440363956052327, 50.07712209464535], [14.432358134093018, 50.07706976901163], [14.440363956052327, 50.07706976901163], [14.432358134093018, 50.077017443377905], [14.440363956052327, 50.077017443377905], [14.432358134093018, 50.07696511774419], [14.440363956052327, 50.07696511774419], [14.432358134093018, 50.07691279211046], [14.440363956052327, 50.07691279211046], [14.432358134093018, 50.076860466476745], [14.440363956052327, 50.076860466476745], [14.432358134093018, 50.07680814084302], [14.440363956052327, 50.07680814084302], [14.432358134093018, 50.0767558152093], [14.440363956052327, 50.0767558152093], [14.432358134093018, 50.07670348957558], [14.440363956052327, 50.07670348957558], [14.432358134093018, 50.07665116394186], [14.440363956052327, 50.07665116394186], [14.432358134093018, 50.076598838308136], [14.440363956052327, 50.076598838308136], [14.432358134093018, 50.07654651267442], [14.435288369581393, 50.07654651267442], [14.435811625918602, 50.07654651267442], [14.438584884505813, 50.07654651267442], [14.440468607319769, 50.07654651267442], [14.43246278536046, 50.076494187040694], [14.43518371831395, 50.076494187040694], [14.43570697465116, 50.076494187040694], [14.438113953802326, 50.076494187040694], [14.438637210139534, 50.076494187040694], [14.439160466476745, 50.076494187040694], [14.440782561122095, 50.076494187040694], [14.43241045972674, 50.07644186140698], [14.432933716063948, 50.07644186140698], [14.433456972401158, 50.07644186140698], [14.43513139268023, 50.07644186140698], [14.435654649017438, 50.07644186140698], [14.436177905354649, 50.07644186140698], [14.43837558197093, 50.07644186140698], [14.43889883830814, 50.07644186140698], [14.439997676616281, 50.07644186140698], [14.44052093295349, 50.07644186140698], [14.4410441892907, 50.07644186140698], [14.441567445627909, 50.07644186140698], [14.432253482825576, 50.07638953577325], [14.432776739162785, 50.07638953577325], [14.433299995499995, 50.07638953577325], [14.434869764511625, 50.07638953577325], [14.435393020848835, 50.07638953577325], [14.435916277186044, 50.07638953577325], [14.437904651267441, 50.07638953577325], [14.438427907604652, 50.07638953577325], [14.43895116394186, 50.07638953577325], [14.43947442027907, 50.07638953577325], [14.440468607319769, 50.07638953577325], [14.44099186365698, 50.07638953577325], [14.441515119994188, 50.07638953577325], [14.432201157191855, 50.076337210139535], [14.432724413529064, 50.076337210139535], [14.433247669866274, 50.076337210139535], [14.433770926203485, 50.076337210139535], [14.435236043947672, 50.076337210139535], [14.43575930028488, 50.076337210139535], [14.436282556622091, 50.076337210139535], [14.438166279436047, 50.076337210139535], [14.438689535773255, 50.076337210139535], [14.439212792110466, 50.076337210139535], [14.440206979151164, 50.076337210139535], [14.440730235488374, 50.076337210139535], [14.441253491825584, 50.076337210139535], [14.441776748162793, 50.076337210139535], [14.43246278536046, 50.07628488450581], [14.432986041697669, 50.07628488450581], [14.43350929803488, 50.07628488450581], [14.434922090145346, 50.07628488450581], [14.435445346482556, 50.07628488450581], [14.435968602819765, 50.07628488450581], [14.437643023098836, 50.07628488450581], [14.438166279436047, 50.07628488450581], [14.438689535773255, 50.07628488450581], [14.439212792110466, 50.07628488450581], [14.440206979151164, 50.07628488450581], [14.440730235488374, 50.07628488450581], [14.441253491825584, 50.07628488450581], [14.441776748162793, 50.07628488450581], [14.43246278536046, 50.07623255887209], [14.432986041697669, 50.07623255887209], [14.43350929803488, 50.07623255887209], [14.434869764511625, 50.07623255887209], [14.435393020848835, 50.07623255887209], [14.435916277186044, 50.07623255887209], [14.436439533523254, 50.07623255887209], [14.438009302534883, 50.07623255887209], [14.438532558872094, 50.07623255887209], [14.439055815209302, 50.07623255887209], [14.44005000225, 50.07623255887209], [14.44057325858721, 50.07623255887209], [14.441096514924421, 50.07623255887209], [14.44161977126163, 50.07623255887209], [14.432305808459297, 50.07618023323837], [14.432829064796506, 50.07618023323837], [14.433352321133716, 50.07618023323837], [14.43466046197674, 50.07618023323837], [14.43518371831395, 50.07618023323837], [14.43570697465116, 50.07618023323837], [14.43623023098837, 50.07618023323837], [14.437747674366278, 50.07618023323837], [14.438270930703489, 50.07618023323837], [14.438794187040697, 50.07618023323837], [14.439317443377908, 50.07618023323837], [14.440311630418606, 50.07618023323837], [14.440834886755816, 50.07618023323837], [14.441358143093026, 50.07618023323837], [14.432044180290692, 50.07612790760465], [14.432567436627902, 50.07612790760465], [14.433090692965111, 50.07612790760465], [14.433613949302321, 50.07612790760465], [14.434869764511625, 50.07612790760465], [14.435393020848835, 50.07612790760465], [14.435916277186044, 50.07612790760465], [14.436439533523254, 50.07612790760465], [14.437904651267441, 50.07612790760465], [14.438427907604652, 50.07612790760465], [14.43895116394186, 50.07612790760465], [14.43947442027907, 50.07612790760465], [14.440468607319769, 50.07612790760465], [14.44099186365698, 50.07612790760465], [14.441515119994188, 50.07612790760465], [14.432567436627902, 50.076075581970926], [14.434712787610462, 50.076075581970926], [14.435236043947672, 50.076075581970926], [14.436387207889533, 50.076075581970926], [14.4378, 50.076075581970926], [14.439108140843024, 50.076075581970926], [14.440468607319769, 50.076075581970926], [14.43246278536046, 50.07602325633721], [14.434555810709298, 50.07602325633721], [14.435079067046509, 50.07602325633721], [14.436439533523254, 50.07602325633721], [14.437747674366278, 50.07602325633721], [14.439369769011629, 50.07602325633721], [14.440730235488374, 50.07602325633721], [14.432724413529064, 50.075970930703484], [14.434817438877904, 50.075970930703484], [14.436334882255812, 50.075970930703484], [14.437643023098836, 50.075970930703484], [14.43947442027907, 50.075970930703484], [14.440834886755816, 50.075970930703484], [14.432829064796506, 50.075918605069766], [14.434869764511625, 50.075918605069766], [14.436491859156975, 50.075918605069766], [14.437747674366278, 50.075918605069766], [14.440625584220932, 50.075918605069766], [14.432619762261623, 50.07586627943604], [14.43460813634302, 50.07586627943604], [14.436334882255812, 50.07586627943604], [14.437590697465115, 50.07586627943604], [14.440468607319769, 50.07586627943604], [14.43246278536046, 50.075813953802324], [14.434451159441856, 50.075813953802324], [14.436282556622091, 50.075813953802324], [14.437433720563952, 50.075813953802324], [14.440363956052327, 50.075813953802324], [14.432358134093018, 50.0757616281686], [14.434346508174414, 50.0757616281686], [14.434869764511625, 50.0757616281686], [14.43675348732558, 50.0757616281686], [14.437904651267441, 50.0757616281686], [14.440834886755816, 50.0757616281686], [14.432829064796506, 50.07570930253488], [14.434765113244183, 50.07570930253488], [14.43670116169186, 50.07570930253488], [14.43785232563372, 50.07570930253488], [14.440782561122095, 50.07570930253488], [14.432776739162785, 50.07565697690116], [14.434712787610462, 50.07565697690116], [14.43670116169186, 50.07565697690116], [14.4378, 50.07565697690116], [14.440730235488374, 50.07565697690116], [14.432724413529064, 50.07560465126744], [14.43460813634302, 50.07560465126744], [14.436648836058138, 50.07560465126744], [14.437747674366278, 50.07560465126744], [14.440625584220932, 50.07560465126744], [14.432619762261623, 50.075552325633716], [14.434503485075577, 50.075552325633716], [14.436544184790696, 50.075552325633716], [14.437695348732557, 50.075552325633716], [14.44057325858721, 50.075552325633716], [14.432567436627902, 50.0755], [14.434451159441856, 50.0755], [14.436544184790696, 50.0755], [14.437695348732557, 50.0755], [14.44052093295349, 50.0755], [14.432515110994181, 50.07544767436628], [14.434398833808135, 50.07544767436628], [14.436491859156975, 50.07544767436628], [14.437643023098836, 50.07544767436628], [14.440363956052327, 50.07544767436628], [14.432358134093018, 50.075395348732556], [14.434241856906972, 50.075395348732556], [14.436387207889533, 50.075395348732556], [14.437538371831394, 50.075395348732556], [14.438061628168604, 50.075395348732556], [14.440677909854653, 50.075395348732556], [14.432672087895343, 50.07534302309884], [14.434503485075577, 50.07534302309884], [14.436648836058138, 50.07534302309884], [14.4378, 50.07534302309884], [14.43832325633721, 50.07534302309884], [14.440730235488374, 50.07534302309884], [14.432724413529064, 50.075290697465114], [14.434555810709298, 50.075290697465114], [14.435079067046509, 50.075290697465114], [14.435602323383717, 50.075290697465114], [14.436125579720928, 50.075290697465114], [14.436648836058138, 50.075290697465114], [14.4378, 50.075290697465114], [14.43832325633721, 50.075290697465114], [14.44052093295349, 50.075290697465114], [14.432515110994181, 50.0752383718314], [14.434346508174414, 50.0752383718314], [14.434869764511625, 50.0752383718314], [14.435393020848835, 50.0752383718314], [14.435916277186044, 50.0752383718314], [14.436439533523254, 50.0752383718314], [14.437643023098836, 50.0752383718314], [14.438166279436047, 50.0752383718314], [14.438689535773255, 50.0752383718314], [14.440677909854653, 50.0752383718314], [14.432672087895343, 50.07518604619767], [14.434503485075577, 50.07518604619767], [14.435026741412788, 50.07518604619767], [14.435549997749998, 50.07518604619767], [14.436073254087207, 50.07518604619767], [14.436596510424417, 50.07518604619767], [14.43785232563372, 50.07518604619767], [14.43837558197093, 50.07518604619767], [14.43889883830814, 50.07518604619767], [14.440730235488374, 50.07518604619767], [14.432724413529064, 50.075133720563954], [14.434555810709298, 50.075133720563954], [14.435079067046509, 50.075133720563954], [14.435602323383717, 50.075133720563954], [14.436125579720928, 50.075133720563954], [14.436648836058138, 50.075133720563954], [14.437956976901162, 50.075133720563954], [14.438480233238373, 50.075133720563954], [14.439003489575581, 50.075133720563954], [14.440677909854653, 50.075133720563954], [14.432672087895343, 50.07508139493023], [14.434503485075577, 50.07508139493023], [14.435026741412788, 50.07508139493023], [14.435549997749998, 50.07508139493023], [14.436073254087207, 50.07508139493023], [14.436596510424417, 50.07508139493023], [14.437956976901162, 50.07508139493023], [14.438480233238373, 50.07508139493023], [14.439003489575581, 50.07508139493023], [14.44057325858721, 50.07508139493023], [14.432567436627902, 50.07502906929651], [14.434398833808135, 50.07502906929651], [14.434922090145346, 50.07502906929651], [14.435445346482556, 50.07502906929651], [14.435968602819765, 50.07502906929651], [14.436491859156975, 50.07502906929651], [14.437904651267441, 50.07502906929651], [14.438427907604652, 50.07502906929651], [14.43895116394186, 50.07502906929651], [14.440468607319769, 50.07502906929651], [14.43246278536046, 50.07497674366279], [14.434294182540693, 50.07497674366279], [14.434817438877904, 50.07497674366279], [14.435340695215114, 50.07497674366279], [14.435863951552323, 50.07497674366279], [14.436387207889533, 50.07497674366279], [14.437904651267441, 50.07497674366279], [14.438427907604652, 50.07497674366279], [14.43895116394186, 50.07497674366279], [14.440363956052327, 50.07497674366279], [14.432358134093018, 50.07492441802907], [14.434189531273251, 50.07492441802907], [14.438061628168604, 50.07492441802907], [14.438584884505813, 50.07492441802907], [14.439108140843024, 50.07492441802907], [14.44052093295349, 50.07492441802907], [14.432515110994181, 50.074872092395346], [14.434346508174414, 50.074872092395346], [14.43837558197093, 50.074872092395346], [14.43889883830814, 50.074872092395346], [14.43942209464535, 50.074872092395346], [14.440782561122095, 50.074872092395346], [14.432776739162785, 50.07481976676163], [14.43460813634302, 50.07481976676163], [14.438846512674418, 50.07481976676163], [14.439369769011629, 50.07481976676163], [14.440677909854653, 50.07481976676163], [14.432672087895343, 50.074767441127904], [14.434503485075577, 50.074767441127904], [14.43895116394186, 50.074767441127904], [14.43947442027907, 50.074767441127904], [14.440782561122095, 50.074767441127904], [14.432776739162785, 50.074715115494186], [14.43460813634302, 50.074715115494186], [14.439212792110466, 50.074715115494186], [14.440468607319769, 50.074715115494186], [14.43246278536046, 50.07466278986046], [14.434346508174414, 50.07466278986046], [14.439055815209302, 50.07466278986046], [14.439579071546513, 50.07466278986046], [14.440834886755816, 50.07466278986046], [14.432829064796506, 50.074610464226744], [14.434712787610462, 50.074610464226744], [14.43947442027907, 50.074610464226744], [14.440730235488374, 50.074610464226744], [14.432724413529064, 50.07455813859302], [14.43460813634302, 50.07455813859302], [14.439369769011629, 50.07455813859302], [14.440625584220932, 50.07455813859302], [14.432619762261623, 50.0745058129593], [14.434503485075577, 50.0745058129593], [14.439317443377908, 50.0745058129593], [14.44052093295349, 50.0745058129593], [14.432515110994181, 50.07445348732558], [14.434451159441856, 50.07445348732558], [14.439212792110466, 50.07445348732558], [14.440416281686048, 50.07445348732558], [14.43241045972674, 50.07440116169186], [14.434346508174414, 50.07440116169186], [14.439108140843024, 50.07440116169186], [14.439631397180234, 50.07440116169186], [14.440834886755816, 50.07440116169186], [14.432829064796506, 50.074348836058135], [14.434765113244183, 50.074348836058135], [14.43947442027907, 50.074348836058135], [14.440677909854653, 50.074348836058135], [14.432672087895343, 50.07429651042442], [14.43466046197674, 50.07429651042442], [14.439317443377908, 50.07429651042442], [14.44052093295349, 50.07429651042442], [14.432515110994181, 50.07424418479069], [14.434503485075577, 50.07424418479069], [14.439108140843024, 50.07424418479069], [14.440363956052327, 50.07424418479069], [14.432358134093018, 50.074191859156976], [14.432881390430227, 50.074191859156976], [14.434869764511625, 50.074191859156976], [14.439108140843024, 50.074191859156976], [14.440363956052327, 50.074191859156976], [14.440887212389537, 50.074191859156976], [14.432829064796506, 50.07413953352325], [14.434817438877904, 50.07413953352325], [14.43675348732558, 50.07413953352325], [14.439317443377908, 50.07413953352325], [14.44057325858721, 50.07413953352325], [14.432567436627902, 50.074087207889534], [14.434555810709298, 50.074087207889534], [14.435079067046509, 50.074087207889534], [14.437486046197673, 50.074087207889534], [14.439212792110466, 50.074087207889534], [14.44052093295349, 50.074087207889534], [14.43246278536046, 50.07403488225581], [14.432986041697669, 50.07403488225581], [14.434922090145346, 50.07403488225581], [14.436387207889533, 50.07403488225581], [14.437538371831394, 50.07403488225581], [14.439003489575581, 50.07403488225581], [14.439526745912792, 50.07403488225581], [14.440887212389537, 50.07403488225581], [14.432724413529064, 50.07398255662209], [14.433247669866274, 50.07398255662209], [14.433770926203485, 50.07398255662209], [14.435026741412788, 50.07398255662209], [14.436073254087207, 50.07398255662209], [14.436596510424417, 50.07398255662209], [14.437747674366278, 50.07398255662209], [14.438846512674418, 50.07398255662209], [14.439369769011629, 50.07398255662209], [14.440730235488374, 50.07398255662209], [14.441253491825584, 50.07398255662209], [14.441776748162793, 50.07398255662209], [14.432933716063948, 50.07393023098837], [14.433456972401158, 50.07393023098837], [14.434712787610462, 50.07393023098837], [14.435236043947672, 50.07393023098837], [14.43575930028488, 50.07393023098837], [14.436282556622091, 50.07393023098837], [14.437433720563952, 50.07393023098837], [14.437956976901162, 50.07393023098837], [14.438480233238373, 50.07393023098837], [14.439003489575581, 50.07393023098837], [14.440468607319769, 50.07393023098837], [14.44099186365698, 50.07393023098837], [14.441515119994188, 50.07393023098837], [14.432672087895343, 50.07387790535465], [14.433195344232553, 50.07387790535465], [14.433718600569764, 50.07387790535465], [14.435026741412788, 50.07387790535465], [14.435549997749998, 50.07387790535465], [14.436073254087207, 50.07387790535465], [14.436596510424417, 50.07387790535465], [14.437747674366278, 50.07387790535465], [14.438270930703489, 50.07387790535465], [14.438794187040697, 50.07387790535465], [14.439317443377908, 50.07387790535465], [14.440834886755816, 50.07387790535465], [14.441358143093026, 50.07387790535465], [14.432567436627902, 50.073825579720925], [14.433090692965111, 50.073825579720925], [14.433613949302321, 50.073825579720925], [14.435026741412788, 50.073825579720925], [14.435549997749998, 50.073825579720925], [14.436073254087207, 50.073825579720925], [14.436596510424417, 50.073825579720925], [14.437747674366278, 50.073825579720925], [14.438270930703489, 50.073825579720925], [14.438794187040697, 50.073825579720925], [14.439317443377908, 50.073825579720925], [14.440939538023258, 50.073825579720925], [14.441462794360469, 50.073825579720925], [14.432724413529064, 50.07377325408721], [14.433247669866274, 50.07377325408721], [14.433770926203485, 50.07377325408721], [14.435236043947672, 50.07377325408721], [14.43575930028488, 50.07377325408721], [14.436282556622091, 50.07377325408721], [14.437433720563952, 50.07377325408721], [14.437956976901162, 50.07377325408721], [14.438480233238373, 50.07377325408721], [14.439003489575581, 50.07377325408721], [14.440730235488374, 50.07377325408721], [14.441253491825584, 50.07377325408721], [14.441776748162793, 50.07377325408721], [14.433090692965111, 50.07372092845348], [14.433613949302321, 50.07372092845348], [14.43513139268023, 50.07372092845348], [14.435654649017438, 50.07372092845348], [14.436177905354649, 50.07372092845348], [14.43670116169186, 50.07372092845348], [14.437904651267441, 50.07372092845348], [14.438427907604652, 50.07372092845348], [14.43895116394186, 50.07372092845348], [14.440782561122095, 50.07372092845348], [14.441305817459305, 50.07372092845348], [14.432724413529064, 50.073668602819765], [14.433247669866274, 50.073668602819765], [14.433770926203485, 50.073668602819765], [14.435393020848835, 50.073668602819765], [14.435916277186044, 50.073668602819765], [14.436439533523254, 50.073668602819765], [14.437904651267441, 50.073668602819765], [14.438427907604652, 50.073668602819765], [14.43895116394186, 50.073668602819765], [14.44099186365698, 50.073668602819765], [14.441515119994188, 50.073668602819765], [14.43303836733139, 50.07361627718604], [14.4335616236686, 50.07361627718604], [14.435340695215114, 50.07361627718604], [14.435863951552323, 50.07361627718604], [14.436387207889533, 50.07361627718604], [14.438166279436047, 50.07361627718604], [14.438689535773255, 50.07361627718604], [14.440939538023258, 50.07361627718604], [14.441462794360469, 50.07361627718604], [14.435393020848835, 50.07356395155232], [14.435916277186044, 50.07356395155232], [14.438113953802326, 50.07356395155232], [14.438637210139534, 50.07356395155232]], &quot;type&quot;: &quot;MultiPoint&quot;});

        
</script>" style="position:absolute;width:100%;height:100%;left:0;top:0;border:none !important;" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen=""></iframe></div></div>
</div>
</div>
<p>All credit to Copilot! Good lord it did a good job there.</p>
</section>
<section id="make-it-a-linestring" class="level2">
<h2 class="anchored" data-anchor-id="make-it-a-linestring">Make it a linestring</h2>
<div class="cell" data-execution_count="2">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a linestring from the points by finding the nearest neighbour for each point</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.spatial <span class="im">import</span> distance_matrix</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the distance matrix</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>raw_points <span class="op">=</span> np.array([lon, lat]).T</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>d_matrix <span class="op">=</span> distance_matrix(raw_points, raw_points)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co"># In order to avoid the diagonal, set the zeros to infinity</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>d_matrix[d_matrix <span class="op">==</span> <span class="dv">0</span>] <span class="op">=</span> np.inf</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Starting with the first point, find the nearest neighbour that is not already in the linestring</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>points <span class="op">=</span> []</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>current_point <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(lon)):</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>    points.append(shapely.geometry.Point(lon[current_point], lat[current_point]))</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Set the current point to infinity so that it is not chosen again</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    d_matrix[:, current_point] <span class="op">=</span> np.inf</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Find the nearest neighbour</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>    current_point <span class="op">=</span> np.argmin(d_matrix[current_point, :])</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the linestring</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>linestring <span class="op">=</span> shapely.geometry.LineString(points)</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the linestring</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> folium.Map(location<span class="op">=</span>[prague[<span class="dv">1</span>], prague[<span class="dv">0</span>]], zoom_start<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>folium.GeoJson(linestring).add_to(m)</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>m</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="5">
<div style="width:100%;"><div style="position:relative;width:100%;height:0;padding-bottom:60%;"><span style="color:#565656">Make this Notebook Trusted to load map: File -&gt; Trust Notebook</span><iframe srcdoc="<!DOCTYPE html>
<head>    
    <meta http-equiv=&quot;content-type&quot; content=&quot;text/html; charset=UTF-8&quot; />
    
        <script>
            L_NO_TOUCH = false;
            L_DISABLE_3D = false;
        </script>
    
    <style>html, body {width: 100%;height: 100%;margin: 0;padding: 0;}</style>
    <style>#map {position:absolute;top:0;bottom:0;right:0;left:0;}</style>
    <script src=&quot;https://cdn.jsdelivr.net/npm/leaflet@1.6.0/dist/leaflet.js&quot;></script>
    <script src=&quot;https://code.jquery.com/jquery-1.12.4.min.js&quot;></script>
    <script src=&quot;https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js&quot;></script>
    <script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.js&quot;></script>
    <link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/npm/leaflet@1.6.0/dist/leaflet.css&quot;/>
    <link rel=&quot;stylesheet&quot; href=&quot;https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css&quot;/>
    <link rel=&quot;stylesheet&quot; href=&quot;https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap-theme.min.css&quot;/>
    <link rel=&quot;stylesheet&quot; href=&quot;https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css&quot;/>
    <link rel=&quot;stylesheet&quot; href=&quot;https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.css&quot;/>
    <link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/gh/python-visualization/folium/folium/templates/leaflet.awesome.rotate.min.css&quot;/>
    
            <meta name=&quot;viewport&quot; content=&quot;width=device-width,
                initial-scale=1.0, maximum-scale=1.0, user-scalable=no&quot; />
            <style>
                #map_0c6a6ad588caf761e4ef9f1a0cb413d8 {
                    position: relative;
                    width: 100.0%;
                    height: 100.0%;
                    left: 0.0%;
                    top: 0.0%;
                }
            </style>
        
</head>
<body>    
    
            <div class=&quot;folium-map&quot; id=&quot;map_0c6a6ad588caf761e4ef9f1a0cb413d8&quot; ></div>
        
</body>
<script>    
    
            var map_0c6a6ad588caf761e4ef9f1a0cb413d8 = L.map(
                &quot;map_0c6a6ad588caf761e4ef9f1a0cb413d8&quot;,
                {
                    center: [50.0755, 14.4378],
                    crs: L.CRS.EPSG3857,
                    zoom: 15,
                    zoomControl: true,
                    preferCanvas: false,
                }
            );

            

        
    
            var tile_layer_f89f3e0d0745bad7e92af91901fe28d1 = L.tileLayer(
                &quot;https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png&quot;,
                {&quot;attribution&quot;: &quot;Data by \u0026copy; \u003ca href=\&quot;http://openstreetmap.org\&quot;\u003eOpenStreetMap\u003c/a\u003e, under \u003ca href=\&quot;http://www.openstreetmap.org/copyright\&quot;\u003eODbL\u003c/a\u003e.&quot;, &quot;detectRetina&quot;: false, &quot;maxNativeZoom&quot;: 18, &quot;maxZoom&quot;: 18, &quot;minZoom&quot;: 0, &quot;noWrap&quot;: false, &quot;opacity&quot;: 1, &quot;subdomains&quot;: &quot;abc&quot;, &quot;tms&quot;: false}
            ).addTo(map_0c6a6ad588caf761e4ef9f1a0cb413d8);
        
    

        function geo_json_f3c0b8b17e1a12b4f66022472de54ef5_onEachFeature(feature, layer) {
            layer.on({
            });
        };
        var geo_json_f3c0b8b17e1a12b4f66022472de54ef5 = L.geoJson(null, {
                onEachFeature: geo_json_f3c0b8b17e1a12b4f66022472de54ef5_onEachFeature,
            
        });

        function geo_json_f3c0b8b17e1a12b4f66022472de54ef5_add (data) {
            geo_json_f3c0b8b17e1a12b4f66022472de54ef5
                .addData(data)
                .addTo(map_0c6a6ad588caf761e4ef9f1a0cb413d8);
        }
            geo_json_f3c0b8b17e1a12b4f66022472de54ef5_add({&quot;coordinates&quot;: [[14.432358134093018, 50.07722674591279], [14.432358134093018, 50.07717442027907], [14.432358134093018, 50.07712209464535], [14.432358134093018, 50.07706976901163], [14.432358134093018, 50.077017443377905], [14.432358134093018, 50.07696511774419], [14.432358134093018, 50.07691279211046], [14.432358134093018, 50.076860466476745], [14.432358134093018, 50.07680814084302], [14.432358134093018, 50.0767558152093], [14.432358134093018, 50.07670348957558], [14.432358134093018, 50.07665116394186], [14.432358134093018, 50.076598838308136], [14.432358134093018, 50.07654651267442], [14.43241045972674, 50.07644186140698], [14.43246278536046, 50.076494187040694], [14.43246278536046, 50.07628488450581], [14.43246278536046, 50.07623255887209], [14.432567436627902, 50.07612790760465], [14.432567436627902, 50.076075581970926], [14.43246278536046, 50.07602325633721], [14.43246278536046, 50.075813953802324], [14.432358134093018, 50.0757616281686], [14.432619762261623, 50.07586627943604], [14.432724413529064, 50.075970930703484], [14.432829064796506, 50.075918605069766], [14.432829064796506, 50.07570930253488], [14.432776739162785, 50.07565697690116], [14.432724413529064, 50.07560465126744], [14.432619762261623, 50.075552325633716], [14.432567436627902, 50.0755], [14.432515110994181, 50.07544767436628], [14.432358134093018, 50.075395348732556], [14.432515110994181, 50.0752383718314], [14.432672087895343, 50.07518604619767], [14.432724413529064, 50.075133720563954], [14.432672087895343, 50.07508139493023], [14.432567436627902, 50.07502906929651], [14.43246278536046, 50.07497674366279], [14.432358134093018, 50.07492441802907], [14.432515110994181, 50.074872092395346], [14.432672087895343, 50.074767441127904], [14.432776739162785, 50.074715115494186], [14.432776739162785, 50.07481976676163], [14.432829064796506, 50.074610464226744], [14.432724413529064, 50.07455813859302], [14.432619762261623, 50.0745058129593], [14.432515110994181, 50.07445348732558], [14.43241045972674, 50.07440116169186], [14.432515110994181, 50.07424418479069], [14.432567436627902, 50.074087207889534], [14.43246278536046, 50.07403488225581], [14.432358134093018, 50.074191859156976], [14.432672087895343, 50.07429651042442], [14.432829064796506, 50.074348836058135], [14.432881390430227, 50.074191859156976], [14.432829064796506, 50.07413953352325], [14.432724413529064, 50.07398255662209], [14.432672087895343, 50.07387790535465], [14.432567436627902, 50.073825579720925], [14.432724413529064, 50.07377325408721], [14.432724413529064, 50.073668602819765], [14.43303836733139, 50.07361627718604], [14.433090692965111, 50.07372092845348], [14.433090692965111, 50.073825579720925], [14.433195344232553, 50.07387790535465], [14.433247669866274, 50.07398255662209], [14.433247669866274, 50.07377325408721], [14.433247669866274, 50.073668602819765], [14.4335616236686, 50.07361627718604], [14.433613949302321, 50.07372092845348], [14.433613949302321, 50.073825579720925], [14.433718600569764, 50.07387790535465], [14.433770926203485, 50.07398255662209], [14.433770926203485, 50.07377325408721], [14.433770926203485, 50.073668602819765], [14.433456972401158, 50.07393023098837], [14.432986041697669, 50.07403488225581], [14.432933716063948, 50.07393023098837], [14.43246278536046, 50.07466278986046], [14.432724413529064, 50.075290697465114], [14.432672087895343, 50.07534302309884], [14.432829064796506, 50.07618023323837], [14.432986041697669, 50.07623255887209], [14.432986041697669, 50.07628488450581], [14.432933716063948, 50.07644186140698], [14.432776739162785, 50.07638953577325], [14.432724413529064, 50.076337210139535], [14.433090692965111, 50.07612790760465], [14.433247669866274, 50.076337210139535], [14.433299995499995, 50.07638953577325], [14.433456972401158, 50.07644186140698], [14.43350929803488, 50.07628488450581], [14.43350929803488, 50.07623255887209], [14.433613949302321, 50.07612790760465], [14.433770926203485, 50.076337210139535], [14.433352321133716, 50.07618023323837], [14.432305808459297, 50.07618023323837], [14.432201157191855, 50.076337210139535], [14.432253482825576, 50.07638953577325], [14.432044180290692, 50.07612790760465], [14.434241856906972, 50.075395348732556], [14.434398833808135, 50.07544767436628], [14.434451159441856, 50.0755], [14.434503485075577, 50.075552325633716], [14.43460813634302, 50.07560465126744], [14.434712787610462, 50.07565697690116], [14.434765113244183, 50.07570930253488], [14.434869764511625, 50.0757616281686], [14.434869764511625, 50.075918605069766], [14.434817438877904, 50.075970930703484], [14.434712787610462, 50.076075581970926], [14.43466046197674, 50.07618023323837], [14.434555810709298, 50.07602325633721], [14.43460813634302, 50.07586627943604], [14.434451159441856, 50.075813953802324], [14.434346508174414, 50.0757616281686], [14.434503485075577, 50.07534302309884], [14.434555810709298, 50.075290697465114], [14.434503485075577, 50.07518604619767], [14.434555810709298, 50.075133720563954], [14.434503485075577, 50.07508139493023], [14.434398833808135, 50.07502906929651], [14.434294182540693, 50.07497674366279], [14.434189531273251, 50.07492441802907], [14.434346508174414, 50.074872092395346], [14.434503485075577, 50.074767441127904], [14.43460813634302, 50.074715115494186], [14.43460813634302, 50.07481976676163], [14.434712787610462, 50.074610464226744], [14.43460813634302, 50.07455813859302], [14.434503485075577, 50.0745058129593], [14.434451159441856, 50.07445348732558], [14.434346508174414, 50.07440116169186], [14.434503485075577, 50.07424418479069], [14.434555810709298, 50.074087207889534], [14.434712787610462, 50.07393023098837], [14.434817438877904, 50.07413953352325], [14.434869764511625, 50.074191859156976], [14.434922090145346, 50.07403488225581], [14.435026741412788, 50.07398255662209], [14.435026741412788, 50.07387790535465], [14.435026741412788, 50.073825579720925], [14.43513139268023, 50.07372092845348], [14.435236043947672, 50.07377325408721], [14.435236043947672, 50.07393023098837], [14.435079067046509, 50.074087207889534], [14.434765113244183, 50.074348836058135], [14.43466046197674, 50.07429651042442], [14.434346508174414, 50.07466278986046], [14.434817438877904, 50.07497674366279], [14.434922090145346, 50.07502906929651], [14.435026741412788, 50.07508139493023], [14.435079067046509, 50.075133720563954], [14.435026741412788, 50.07518604619767], [14.435079067046509, 50.075290697465114], [14.434869764511625, 50.0752383718314], [14.434346508174414, 50.0752383718314], [14.435340695215114, 50.07497674366279], [14.435445346482556, 50.07502906929651], [14.435549997749998, 50.07508139493023], [14.435602323383717, 50.075133720563954], [14.435549997749998, 50.07518604619767], [14.435602323383717, 50.075290697465114], [14.435393020848835, 50.0752383718314], [14.435916277186044, 50.0752383718314], [14.436073254087207, 50.07518604619767], [14.436125579720928, 50.075133720563954], [14.436073254087207, 50.07508139493023], [14.435968602819765, 50.07502906929651], [14.435863951552323, 50.07497674366279], [14.436125579720928, 50.075290697465114], [14.436387207889533, 50.075395348732556], [14.436491859156975, 50.07544767436628], [14.436544184790696, 50.0755], [14.436544184790696, 50.075552325633716], [14.436648836058138, 50.07560465126744], [14.43670116169186, 50.07565697690116], [14.43670116169186, 50.07570930253488], [14.43675348732558, 50.0757616281686], [14.436491859156975, 50.075918605069766], [14.436439533523254, 50.07602325633721], [14.436387207889533, 50.076075581970926], [14.436439533523254, 50.07612790760465], [14.436439533523254, 50.07623255887209], [14.436282556622091, 50.076337210139535], [14.436177905354649, 50.07644186140698], [14.435968602819765, 50.07628488450581], [14.435916277186044, 50.07623255887209], [14.435916277186044, 50.07612790760465], [14.43570697465116, 50.07618023323837], [14.43575930028488, 50.076337210139535], [14.435654649017438, 50.07644186140698], [14.43570697465116, 50.076494187040694], [14.435811625918602, 50.07654651267442], [14.435916277186044, 50.07638953577325], [14.43623023098837, 50.07618023323837], [14.436334882255812, 50.075970930703484], [14.436334882255812, 50.07586627943604], [14.436282556622091, 50.075813953802324], [14.436439533523254, 50.0752383718314], [14.436596510424417, 50.07518604619767], [14.436648836058138, 50.075133720563954], [14.436596510424417, 50.07508139493023], [14.436491859156975, 50.07502906929651], [14.436387207889533, 50.07497674366279], [14.436648836058138, 50.075290697465114], [14.436648836058138, 50.07534302309884], [14.437538371831394, 50.075395348732556], [14.437643023098836, 50.07544767436628], [14.437695348732557, 50.0755], [14.437695348732557, 50.075552325633716], [14.437747674366278, 50.07560465126744], [14.4378, 50.07565697690116], [14.43785232563372, 50.07570930253488], [14.437904651267441, 50.0757616281686], [14.437747674366278, 50.075918605069766], [14.437747674366278, 50.07602325633721], [14.4378, 50.076075581970926], [14.437747674366278, 50.07618023323837], [14.437643023098836, 50.07628488450581], [14.437904651267441, 50.07638953577325], [14.438009302534883, 50.07623255887209], [14.437904651267441, 50.07612790760465], [14.438166279436047, 50.07628488450581], [14.438166279436047, 50.076337210139535], [14.438113953802326, 50.076494187040694], [14.43837558197093, 50.07644186140698], [14.438427907604652, 50.07638953577325], [14.438532558872094, 50.07623255887209], [14.438427907604652, 50.07612790760465], [14.438270930703489, 50.07618023323837], [14.438689535773255, 50.07628488450581], [14.438689535773255, 50.076337210139535], [14.438637210139534, 50.076494187040694], [14.438584884505813, 50.07654651267442], [14.43889883830814, 50.07644186140698], [14.43895116394186, 50.07638953577325], [14.439055815209302, 50.07623255887209], [14.43895116394186, 50.07612790760465], [14.438794187040697, 50.07618023323837], [14.439108140843024, 50.076075581970926], [14.439212792110466, 50.07628488450581], [14.439212792110466, 50.076337210139535], [14.439160466476745, 50.076494187040694], [14.43947442027907, 50.07638953577325], [14.43947442027907, 50.07612790760465], [14.439369769011629, 50.07602325633721], [14.43947442027907, 50.075970930703484], [14.439317443377908, 50.07618023323837], [14.439997676616281, 50.07644186140698], [14.44005000225, 50.07623255887209], [14.440206979151164, 50.07628488450581], [14.440206979151164, 50.076337210139535], [14.440311630418606, 50.07618023323837], [14.440468607319769, 50.07612790760465], [14.440468607319769, 50.076075581970926], [14.44057325858721, 50.07623255887209], [14.440730235488374, 50.07628488450581], [14.440730235488374, 50.076337210139535], [14.440782561122095, 50.076494187040694], [14.44099186365698, 50.07638953577325], [14.4410441892907, 50.07644186140698], [14.441096514924421, 50.07623255887209], [14.44099186365698, 50.07612790760465], [14.440834886755816, 50.07618023323837], [14.440730235488374, 50.07602325633721], [14.440834886755816, 50.075970930703484], [14.440834886755816, 50.0757616281686], [14.440782561122095, 50.07570930253488], [14.440730235488374, 50.07565697690116], [14.440625584220932, 50.07560465126744], [14.44057325858721, 50.075552325633716], [14.44052093295349, 50.0755], [14.440363956052327, 50.07544767436628], [14.44052093295349, 50.075290697465114], [14.440677909854653, 50.0752383718314], [14.440730235488374, 50.07518604619767], [14.440677909854653, 50.075133720563954], [14.44057325858721, 50.07508139493023], [14.440468607319769, 50.07502906929651], [14.44052093295349, 50.07492441802907], [14.440363956052327, 50.07497674366279], [14.440468607319769, 50.074715115494186], [14.44052093295349, 50.0745058129593], [14.440625584220932, 50.07455813859302], [14.440730235488374, 50.074610464226744], [14.440834886755816, 50.07466278986046], [14.440782561122095, 50.074767441127904], [14.440782561122095, 50.074872092395346], [14.440677909854653, 50.07481976676163], [14.440834886755816, 50.07440116169186], [14.440677909854653, 50.074348836058135], [14.44052093295349, 50.07429651042442], [14.440363956052327, 50.07424418479069], [14.440363956052327, 50.074191859156976], [14.44052093295349, 50.074087207889534], [14.44057325858721, 50.07413953352325], [14.440730235488374, 50.07398255662209], [14.440834886755816, 50.07387790535465], [14.440939538023258, 50.073825579720925], [14.44099186365698, 50.07393023098837], [14.440887212389537, 50.07403488225581], [14.440887212389537, 50.074191859156976], [14.441253491825584, 50.07398255662209], [14.441358143093026, 50.07387790535465], [14.441462794360469, 50.073825579720925], [14.441515119994188, 50.07393023098837], [14.441515119994188, 50.073668602819765], [14.441462794360469, 50.07361627718604], [14.441305817459305, 50.07372092845348], [14.441253491825584, 50.07377325408721], [14.44099186365698, 50.073668602819765], [14.440939538023258, 50.07361627718604], [14.440782561122095, 50.07372092845348], [14.440730235488374, 50.07377325408721], [14.440468607319769, 50.07393023098837], [14.440416281686048, 50.07445348732558], [14.439631397180234, 50.07440116169186], [14.43947442027907, 50.074348836058135], [14.439317443377908, 50.07429651042442], [14.439317443377908, 50.07413953352325], [14.439212792110466, 50.074087207889534], [14.439108140843024, 50.074191859156976], [14.439108140843024, 50.07424418479069], [14.439108140843024, 50.07440116169186], [14.439212792110466, 50.07445348732558], [14.439317443377908, 50.0745058129593], [14.439369769011629, 50.07455813859302], [14.43947442027907, 50.074610464226744], [14.439579071546513, 50.07466278986046], [14.43947442027907, 50.074767441127904], [14.43942209464535, 50.074872092395346], [14.439369769011629, 50.07481976676163], [14.439212792110466, 50.074715115494186], [14.439055815209302, 50.07466278986046], [14.43895116394186, 50.074767441127904], [14.43889883830814, 50.074872092395346], [14.438846512674418, 50.07481976676163], [14.43895116394186, 50.07497674366279], [14.43895116394186, 50.07502906929651], [14.439003489575581, 50.07508139493023], [14.439003489575581, 50.075133720563954], [14.43889883830814, 50.07518604619767], [14.438689535773255, 50.0752383718314], [14.438480233238373, 50.075133720563954], [14.438480233238373, 50.07508139493023], [14.438427907604652, 50.07502906929651], [14.438427907604652, 50.07497674366279], [14.43837558197093, 50.074872092395346], [14.438584884505813, 50.07492441802907], [14.43837558197093, 50.07518604619767], [14.43832325633721, 50.075290697465114], [14.43832325633721, 50.07534302309884], [14.438166279436047, 50.0752383718314], [14.438061628168604, 50.075395348732556], [14.4378, 50.07534302309884], [14.4378, 50.075290697465114], [14.43785232563372, 50.07518604619767], [14.437956976901162, 50.075133720563954], [14.437956976901162, 50.07508139493023], [14.437904651267441, 50.07502906929651], [14.437904651267441, 50.07497674366279], [14.438061628168604, 50.07492441802907], [14.437643023098836, 50.0752383718314], [14.437433720563952, 50.075813953802324], [14.437590697465115, 50.07586627943604], [14.437643023098836, 50.075970930703484], [14.439108140843024, 50.07492441802907], [14.439003489575581, 50.07403488225581], [14.439003489575581, 50.07393023098837], [14.439003489575581, 50.07377325408721], [14.43895116394186, 50.07372092845348], [14.43895116394186, 50.073668602819765], [14.438794187040697, 50.073825579720925], [14.438794187040697, 50.07387790535465], [14.438846512674418, 50.07398255662209], [14.438480233238373, 50.07393023098837], [14.438480233238373, 50.07377325408721], [14.438427907604652, 50.07372092845348], [14.438427907604652, 50.073668602819765], [14.438270930703489, 50.073825579720925], [14.438270930703489, 50.07387790535465], [14.438166279436047, 50.07361627718604], [14.438113953802326, 50.07356395155232], [14.437904651267441, 50.073668602819765], [14.437904651267441, 50.07372092845348], [14.437956976901162, 50.07377325408721], [14.437956976901162, 50.07393023098837], [14.437747674366278, 50.07387790535465], [14.437747674366278, 50.073825579720925], [14.437747674366278, 50.07398255662209], [14.437538371831394, 50.07403488225581], [14.437486046197673, 50.074087207889534], [14.437433720563952, 50.07393023098837], [14.437433720563952, 50.07377325408721], [14.43670116169186, 50.07372092845348], [14.436596510424417, 50.073825579720925], [14.436596510424417, 50.07387790535465], [14.436596510424417, 50.07398255662209], [14.436387207889533, 50.07403488225581], [14.436282556622091, 50.07393023098837], [14.436282556622091, 50.07377325408721], [14.436177905354649, 50.07372092845348], [14.436073254087207, 50.073825579720925], [14.436073254087207, 50.07387790535465], [14.436073254087207, 50.07398255662209], [14.43575930028488, 50.07393023098837], [14.43575930028488, 50.07377325408721], [14.435654649017438, 50.07372092845348], [14.435549997749998, 50.073825579720925], [14.435549997749998, 50.07387790535465], [14.435393020848835, 50.073668602819765], [14.435340695215114, 50.07361627718604], [14.435393020848835, 50.07356395155232], [14.435863951552323, 50.07361627718604], [14.435916277186044, 50.07356395155232], [14.435916277186044, 50.073668602819765], [14.436387207889533, 50.07361627718604], [14.436439533523254, 50.073668602819765], [14.43675348732558, 50.07413953352325], [14.438637210139534, 50.07356395155232], [14.438689535773255, 50.07361627718604], [14.439317443377908, 50.073825579720925], [14.439317443377908, 50.07387790535465], [14.439369769011629, 50.07398255662209], [14.439526745912792, 50.07403488225581], [14.440730235488374, 50.07534302309884], [14.440677909854653, 50.075395348732556], [14.440468607319769, 50.07586627943604], [14.440363956052327, 50.075813953802324], [14.440625584220932, 50.075918605069766], [14.440468607319769, 50.07638953577325], [14.44052093295349, 50.07644186140698], [14.440468607319769, 50.07654651267442], [14.440363956052327, 50.076598838308136], [14.440363956052327, 50.07665116394186], [14.440363956052327, 50.07670348957558], [14.440363956052327, 50.0767558152093], [14.440363956052327, 50.07680814084302], [14.440363956052327, 50.076860466476745], [14.440363956052327, 50.07691279211046], [14.440363956052327, 50.07696511774419], [14.440363956052327, 50.077017443377905], [14.440363956052327, 50.07706976901163], [14.440363956052327, 50.07712209464535], [14.440363956052327, 50.07717442027907], [14.440363956052327, 50.07722674591279], [14.441253491825584, 50.076337210139535], [14.441253491825584, 50.07628488450581], [14.441358143093026, 50.07618023323837], [14.441515119994188, 50.07612790760465], [14.44161977126163, 50.07623255887209], [14.441776748162793, 50.07628488450581], [14.441776748162793, 50.076337210139535], [14.441567445627909, 50.07644186140698], [14.441515119994188, 50.07638953577325], [14.441776748162793, 50.07398255662209], [14.441776748162793, 50.07377325408721], [14.435393020848835, 50.07612790760465], [14.435393020848835, 50.07623255887209], [14.435445346482556, 50.07628488450581], [14.435393020848835, 50.07638953577325], [14.435236043947672, 50.076337210139535], [14.43513139268023, 50.07644186140698], [14.43518371831395, 50.076494187040694], [14.435288369581393, 50.07654651267442], [14.43518371831395, 50.07618023323837], [14.435236043947672, 50.076075581970926], [14.435079067046509, 50.07602325633721], [14.434869764511625, 50.07612790760465], [14.434869764511625, 50.07623255887209], [14.434922090145346, 50.07628488450581], [14.434869764511625, 50.07638953577325]], &quot;type&quot;: &quot;LineString&quot;});

        
</script>" style="position:absolute;width:100%;height:100%;left:0;top:0;border:none !important;" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen=""></iframe></div></div>
</div>
</div>
<p>Okay, that time I had to get my hands dirty and figure out some of the vector algebra myself.</p>
<p>This is exactly what the future of human-AI looks like (at least until they <a href="https://www.lesswrong.com/posts/uMQ3cqWDPHhjtiesc/agi-ruin-a-list-of-lethalities">destroy all humans</a>)– this is immensely easier than doing it alone would be, however it is still important for me to know what the robot is doing and be able to dive into the details every now and then to improve it when it gets stuck. That MSc. in Physics is not looking useless quite yet!</p>
</section>
<section id="simplify-the-linestring" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="simplify-the-linestring">Simplify the linestring</h2>
<div class="cell" data-execution_count="3">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the euclidian distance in n-space of the route r traversing cities c, ending at the path start.</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># path_distance = lambda r,c: np.sum([np.linalg.norm(c[r[p]]-c[r[p-1]]) for p in range(len(r))])</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>path_distance <span class="op">=</span> <span class="kw">lambda</span> r,c: np.<span class="bu">sum</span>([np.linalg.norm(c[r[p<span class="op">+</span><span class="dv">1</span>]]<span class="op">-</span>c[r[p]]) <span class="cf">for</span> p <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(r)<span class="op">-</span><span class="dv">1</span>)])</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Reverse the order of all elements from element i to element k in array r.</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>two_opt_swap <span class="op">=</span> <span class="kw">lambda</span> r,i,k: np.concatenate((r[<span class="dv">0</span>:i],r[k:<span class="op">-</span><span class="bu">len</span>(r)<span class="op">+</span>i<span class="op">-</span><span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>],r[k<span class="op">+</span><span class="dv">1</span>:<span class="bu">len</span>(r)]))</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> two_opt(cities, improvement_threshold): <span class="co"># 2-opt Algorithm adapted from https://en.wikipedia.org/wiki/2-opt</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    route <span class="op">=</span> np.arange(cities.shape[<span class="dv">0</span>]) <span class="co"># Make an array of row numbers corresponding to cities.</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    improvement_factor <span class="op">=</span> <span class="dv">1</span> <span class="co"># Initialize the improvement factor.</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    best_distance <span class="op">=</span> path_distance(route, cities) <span class="co"># Calculate the distance of the initial path.</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> improvement_factor <span class="op">&gt;</span> improvement_threshold: <span class="co"># If the route is still improving, keep going!</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>        distance_to_beat <span class="op">=</span> best_distance <span class="co"># Record the distance at the beginning of the loop.</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> swap_first <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>,<span class="bu">len</span>(route)<span class="op">-</span><span class="dv">2</span>): <span class="co"># From each city except the first and last,</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> swap_last <span class="kw">in</span> <span class="bu">range</span>(swap_first<span class="op">+</span><span class="dv">1</span>,<span class="bu">len</span>(route)): <span class="co"># to each of the cities following,</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>                new_route <span class="op">=</span> two_opt_swap(route,swap_first,swap_last) <span class="co"># try reversing the order of these cities</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>                new_distance <span class="op">=</span> path_distance(new_route,cities) <span class="co"># and check the total distance with this modification.</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> new_distance <span class="op">&lt;</span> best_distance: <span class="co"># If the path distance is an improvement,</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>                    route <span class="op">=</span> new_route <span class="co"># make this the accepted best route</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>                    best_distance <span class="op">=</span> new_distance <span class="co"># and update the distance corresponding to this route.</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>        improvement_factor <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> best_distance<span class="op">/</span>distance_to_beat <span class="co"># Calculate how much the route has improved.</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> route <span class="co"># When the route is no longer improving substantially, stop searching and return the route.</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>lat <span class="op">=</span> lat[::<span class="dv">4</span>]</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>lon <span class="op">=</span> lon[::<span class="dv">4</span>]</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>cities <span class="op">=</span> np.array([lon, lat]).T</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(cities.shape)</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>route <span class="op">=</span> two_opt(cities, <span class="fl">0.01</span>)</span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder the cities matrix by route order in a new matrix for plotting.</span></span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a><span class="co"># new_cities_order = np.concatenate((np.array([cities[route[i]] for i in range(len(route))]),np.array([cities[0]])))</span></span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>new_cities_order <span class="op">=</span> np.array([cities[route[i]] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(route))])</span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the cities.</span></span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>plt.scatter(cities[:,<span class="dv">0</span>],cities[:,<span class="dv">1</span>])</span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the path.</span></span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>plt.plot(new_cities_order[:,<span class="dv">0</span>],new_cities_order[:,<span class="dv">1</span>])</span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>(119, 2)</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="GIS_0_files/figure-html/cell-4-output-2.png" width="607" height="425"></p>
</div>
</div>
<div class="page-columns page-full"><p>Okay, a bunch of fancy math tricks from SO<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a><a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> didn’t help. But I’m starting to suspect I am seriously overcomplicating this.</p><div class="no-row-height column-margin column-container"><li id="fn1"><p><sup>1</sup>&nbsp;https://stackoverflow.com/questions/25585401/travelling-salesman-in-scipy</p></li><li id="fn2"><p><sup>2</sup>&nbsp;https://gis.stackexchange.com/questions/420940/shortest-path-touching-all-points</p></li></div></div>
<p>Let me see.</p>


<!-- -->

</section>
</section>


</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb6" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Generic</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Fergus Fettes"</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="an">updated:</span><span class="co"> today</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="an">date-format:</span><span class="co"> "MMM D, YYYY"</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="an">title-block-banner:</span><span class="co"> pink</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="an">title-block-banner-color:</span><span class="co"> white</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co"># date-format: iso</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="an">jupyter:</span><span class="co"> python3</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="an">toc:</span><span class="co"> true       # Table of Contents</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="an">reference-location:</span><span class="co"> margin</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="co">    citations-hover: true</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="co">    footnotes-hover: true</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="an">freeze:</span><span class="co"> true</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Specific</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> GIS Map Experiments</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> 2022-10-30T11:37:33+01:00</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a><span class="fu"># Attempt 1 to make running routes from text</span></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Main</span><span class="co">](/Projects/GIS.qmd)</span></span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a><span class="fu">## Convert Text to GPS Coords</span></span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an svg of the word 'test'</span></span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> svgwrite</span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>dwg <span class="op">=</span> svgwrite.Drawing(<span class="st">'test.svg'</span>, profile<span class="op">=</span><span class="st">'tiny'</span>, size<span class="op">=</span>(<span class="st">'60mm'</span>, <span class="st">'23mm'</span>))</span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Add the word 'test' in black</span></span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>dwg.add(dwg.text(<span class="st">'test'</span>, insert<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">80</span>), fill<span class="op">=</span><span class="st">'black'</span>, font_size<span class="op">=</span><span class="dv">100</span>))</span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a>dwg.save()</span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the svg to a png</span></span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> cairosvg</span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a>cairosvg.svg2png(url<span class="op">=</span><span class="st">'test.svg'</span>, write_to<span class="op">=</span><span class="st">'test.png'</span>)</span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the png</span></span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> Image</span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a>Image(filename<span class="op">=</span><span class="st">'test.png'</span>)</span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the png to a geojson</span></span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pyvips</span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb6-54"><a href="#cb6-54" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pyproj</span>
<span id="cb6-55"><a href="#cb6-55" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> shapely.geometry</span>
<span id="cb6-56"><a href="#cb6-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-57"><a href="#cb6-57" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the png</span></span>
<span id="cb6-58"><a href="#cb6-58" aria-hidden="true" tabindex="-1"></a>image <span class="op">=</span> pyvips.Image.new_from_file(<span class="st">'test.png'</span>, access<span class="op">=</span><span class="st">'sequential'</span>)</span>
<span id="cb6-59"><a href="#cb6-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-60"><a href="#cb6-60" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the png to a numpy array</span></span>
<span id="cb6-61"><a href="#cb6-61" aria-hidden="true" tabindex="-1"></a>image <span class="op">=</span> np.array(image)</span>
<span id="cb6-62"><a href="#cb6-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-63"><a href="#cb6-63" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the width and height of the image</span></span>
<span id="cb6-64"><a href="#cb6-64" aria-hidden="true" tabindex="-1"></a>width <span class="op">=</span> image.shape[<span class="dv">1</span>]</span>
<span id="cb6-65"><a href="#cb6-65" aria-hidden="true" tabindex="-1"></a>height <span class="op">=</span> image.shape[<span class="dv">0</span>]</span>
<span id="cb6-66"><a href="#cb6-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-67"><a href="#cb6-67" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the x and y coordinates of the pixels</span></span>
<span id="cb6-68"><a href="#cb6-68" aria-hidden="true" tabindex="-1"></a>x, y <span class="op">=</span> np.meshgrid(np.arange(width), np.arange(height))</span>
<span id="cb6-69"><a href="#cb6-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-70"><a href="#cb6-70" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the red, green and blue values of the pixels</span></span>
<span id="cb6-71"><a href="#cb6-71" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> image[:, :, <span class="dv">0</span>]</span>
<span id="cb6-72"><a href="#cb6-72" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> image[:, :, <span class="dv">1</span>]</span>
<span id="cb6-73"><a href="#cb6-73" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> image[:, :, <span class="dv">2</span>]</span>
<span id="cb6-74"><a href="#cb6-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-75"><a href="#cb6-75" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the alpha values of the pixels</span></span>
<span id="cb6-76"><a href="#cb6-76" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> image[:, :, <span class="dv">3</span>]</span>
<span id="cb6-77"><a href="#cb6-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-78"><a href="#cb6-78" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the x and y coordinates of the pixels that are not transparent</span></span>
<span id="cb6-79"><a href="#cb6-79" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> x[a <span class="op">&gt;</span> <span class="dv">0</span>]</span>
<span id="cb6-80"><a href="#cb6-80" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> y[a <span class="op">&gt;</span> <span class="dv">0</span>]</span>
<span id="cb6-81"><a href="#cb6-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-82"><a href="#cb6-82" aria-hidden="true" tabindex="-1"></a><span class="co"># Center the x and y coordinates on Prague</span></span>
<span id="cb6-83"><a href="#cb6-83" aria-hidden="true" tabindex="-1"></a>prague <span class="op">=</span> (<span class="fl">14.4378</span>, <span class="fl">50.0755</span>)</span>
<span id="cb6-84"><a href="#cb6-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-85"><a href="#cb6-85" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the ratio of the width and height of the image</span></span>
<span id="cb6-86"><a href="#cb6-86" aria-hidden="true" tabindex="-1"></a>ratio <span class="op">=</span> width <span class="op">/</span> height</span>
<span id="cb6-87"><a href="#cb6-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-88"><a href="#cb6-88" aria-hidden="true" tabindex="-1"></a><span class="co"># The final height will be 500 meters</span></span>
<span id="cb6-89"><a href="#cb6-89" aria-hidden="true" tabindex="-1"></a>final_height <span class="op">=</span> <span class="dv">500</span></span>
<span id="cb6-90"><a href="#cb6-90" aria-hidden="true" tabindex="-1"></a>final_width <span class="op">=</span> final_height <span class="op">*</span> ratio</span>
<span id="cb6-91"><a href="#cb6-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-92"><a href="#cb6-92" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the width and height</span></span>
<span id="cb6-93"><a href="#cb6-93" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(final_width, final_height)</span>
<span id="cb6-94"><a href="#cb6-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-95"><a href="#cb6-95" aria-hidden="true" tabindex="-1"></a><span class="co"># Meters to degrees</span></span>
<span id="cb6-96"><a href="#cb6-96" aria-hidden="true" tabindex="-1"></a>meters_to_degrees <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> <span class="dv">111111</span></span>
<span id="cb6-97"><a href="#cb6-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-98"><a href="#cb6-98" aria-hidden="true" tabindex="-1"></a><span class="co"># Degree range</span></span>
<span id="cb6-99"><a href="#cb6-99" aria-hidden="true" tabindex="-1"></a>degree_height <span class="op">=</span> final_height <span class="op">*</span> meters_to_degrees</span>
<span id="cb6-100"><a href="#cb6-100" aria-hidden="true" tabindex="-1"></a>degree_width <span class="op">=</span> final_width <span class="op">*</span> meters_to_degrees</span>
<span id="cb6-101"><a href="#cb6-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-102"><a href="#cb6-102" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the x and y coordinates of the pixels to lat and lon</span></span>
<span id="cb6-103"><a href="#cb6-103" aria-hidden="true" tabindex="-1"></a>lat <span class="op">=</span> np.interp(y, [<span class="dv">0</span>, height], [prague[<span class="dv">1</span>] <span class="op">+</span> degree_height <span class="op">/</span> <span class="dv">2</span>, prague[<span class="dv">1</span>] <span class="op">-</span> degree_height <span class="op">/</span> <span class="dv">2</span>])</span>
<span id="cb6-104"><a href="#cb6-104" aria-hidden="true" tabindex="-1"></a>lon <span class="op">=</span> np.interp(x, [<span class="dv">0</span>, width], [prague[<span class="dv">0</span>] <span class="op">-</span> degree_width <span class="op">/</span> <span class="dv">2</span>, prague[<span class="dv">0</span>] <span class="op">+</span> degree_width <span class="op">/</span> <span class="dv">2</span>])</span>
<span id="cb6-105"><a href="#cb6-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-106"><a href="#cb6-106" aria-hidden="true" tabindex="-1"></a><span class="co"># Decimate the image by a factor of 10</span></span>
<span id="cb6-107"><a href="#cb6-107" aria-hidden="true" tabindex="-1"></a>lat <span class="op">=</span> lat[::<span class="dv">10</span>]</span>
<span id="cb6-108"><a href="#cb6-108" aria-hidden="true" tabindex="-1"></a>lon <span class="op">=</span> lon[::<span class="dv">10</span>]</span>
<span id="cb6-109"><a href="#cb6-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-110"><a href="#cb6-110" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the lat and lon to a geojson</span></span>
<span id="cb6-111"><a href="#cb6-111" aria-hidden="true" tabindex="-1"></a>points <span class="op">=</span> []</span>
<span id="cb6-112"><a href="#cb6-112" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(lat)):</span>
<span id="cb6-113"><a href="#cb6-113" aria-hidden="true" tabindex="-1"></a>    points.append(shapely.geometry.Point(lon[i], lat[i]))</span>
<span id="cb6-114"><a href="#cb6-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-115"><a href="#cb6-115" aria-hidden="true" tabindex="-1"></a>feature <span class="op">=</span> shapely.geometry.MultiPoint(points)</span>
<span id="cb6-116"><a href="#cb6-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-117"><a href="#cb6-117" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the geojson</span></span>
<span id="cb6-118"><a href="#cb6-118" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> folium</span>
<span id="cb6-119"><a href="#cb6-119" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> folium.Map(location<span class="op">=</span>[prague[<span class="dv">1</span>], prague[<span class="dv">0</span>]], zoom_start<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb6-120"><a href="#cb6-120" aria-hidden="true" tabindex="-1"></a>folium.GeoJson(feature).add_to(m)</span>
<span id="cb6-121"><a href="#cb6-121" aria-hidden="true" tabindex="-1"></a>m</span>
<span id="cb6-122"><a href="#cb6-122" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb6-123"><a href="#cb6-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-124"><a href="#cb6-124" aria-hidden="true" tabindex="-1"></a>All credit to Copilot! Good lord it did a good job there.</span>
<span id="cb6-125"><a href="#cb6-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-126"><a href="#cb6-126" aria-hidden="true" tabindex="-1"></a><span class="fu">## Make it a linestring</span></span>
<span id="cb6-127"><a href="#cb6-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-130"><a href="#cb6-130" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb6-131"><a href="#cb6-131" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a linestring from the points by finding the nearest neighbour for each point</span></span>
<span id="cb6-132"><a href="#cb6-132" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.spatial <span class="im">import</span> distance_matrix</span>
<span id="cb6-133"><a href="#cb6-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-134"><a href="#cb6-134" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the distance matrix</span></span>
<span id="cb6-135"><a href="#cb6-135" aria-hidden="true" tabindex="-1"></a>raw_points <span class="op">=</span> np.array([lon, lat]).T</span>
<span id="cb6-136"><a href="#cb6-136" aria-hidden="true" tabindex="-1"></a>d_matrix <span class="op">=</span> distance_matrix(raw_points, raw_points)</span>
<span id="cb6-137"><a href="#cb6-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-138"><a href="#cb6-138" aria-hidden="true" tabindex="-1"></a><span class="co"># In order to avoid the diagonal, set the zeros to infinity</span></span>
<span id="cb6-139"><a href="#cb6-139" aria-hidden="true" tabindex="-1"></a>d_matrix[d_matrix <span class="op">==</span> <span class="dv">0</span>] <span class="op">=</span> np.inf</span>
<span id="cb6-140"><a href="#cb6-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-141"><a href="#cb6-141" aria-hidden="true" tabindex="-1"></a><span class="co"># Starting with the first point, find the nearest neighbour that is not already in the linestring</span></span>
<span id="cb6-142"><a href="#cb6-142" aria-hidden="true" tabindex="-1"></a>points <span class="op">=</span> []</span>
<span id="cb6-143"><a href="#cb6-143" aria-hidden="true" tabindex="-1"></a>current_point <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb6-144"><a href="#cb6-144" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(lon)):</span>
<span id="cb6-145"><a href="#cb6-145" aria-hidden="true" tabindex="-1"></a>    points.append(shapely.geometry.Point(lon[current_point], lat[current_point]))</span>
<span id="cb6-146"><a href="#cb6-146" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Set the current point to infinity so that it is not chosen again</span></span>
<span id="cb6-147"><a href="#cb6-147" aria-hidden="true" tabindex="-1"></a>    d_matrix[:, current_point] <span class="op">=</span> np.inf</span>
<span id="cb6-148"><a href="#cb6-148" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Find the nearest neighbour</span></span>
<span id="cb6-149"><a href="#cb6-149" aria-hidden="true" tabindex="-1"></a>    current_point <span class="op">=</span> np.argmin(d_matrix[current_point, :])</span>
<span id="cb6-150"><a href="#cb6-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-151"><a href="#cb6-151" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the linestring</span></span>
<span id="cb6-152"><a href="#cb6-152" aria-hidden="true" tabindex="-1"></a>linestring <span class="op">=</span> shapely.geometry.LineString(points)</span>
<span id="cb6-153"><a href="#cb6-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-154"><a href="#cb6-154" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the linestring</span></span>
<span id="cb6-155"><a href="#cb6-155" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> folium.Map(location<span class="op">=</span>[prague[<span class="dv">1</span>], prague[<span class="dv">0</span>]], zoom_start<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb6-156"><a href="#cb6-156" aria-hidden="true" tabindex="-1"></a>folium.GeoJson(linestring).add_to(m)</span>
<span id="cb6-157"><a href="#cb6-157" aria-hidden="true" tabindex="-1"></a>m</span>
<span id="cb6-158"><a href="#cb6-158" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb6-159"><a href="#cb6-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-160"><a href="#cb6-160" aria-hidden="true" tabindex="-1"></a>Okay, that time I had to get my hands dirty and figure out some of the vector algebra myself.</span>
<span id="cb6-161"><a href="#cb6-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-162"><a href="#cb6-162" aria-hidden="true" tabindex="-1"></a>This is exactly what the future of human-AI looks like (at least until they <span class="co">[</span><span class="ot">destroy all humans</span><span class="co">](https://www.lesswrong.com/posts/uMQ3cqWDPHhjtiesc/agi-ruin-a-list-of-lethalities)</span>)-- this is immensely easier than doing it alone would be, however it is still important for me to know what the robot is doing and be able to dive into the details every now and then to improve it when it gets stuck. That MSc. in Physics is not looking useless quite yet!</span>
<span id="cb6-163"><a href="#cb6-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-164"><a href="#cb6-164" aria-hidden="true" tabindex="-1"></a><span class="fu">## Simplify the linestring</span></span>
<span id="cb6-165"><a href="#cb6-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-168"><a href="#cb6-168" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb6-169"><a href="#cb6-169" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb6-170"><a href="#cb6-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-171"><a href="#cb6-171" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the euclidian distance in n-space of the route r traversing cities c, ending at the path start.</span></span>
<span id="cb6-172"><a href="#cb6-172" aria-hidden="true" tabindex="-1"></a><span class="co"># path_distance = lambda r,c: np.sum([np.linalg.norm(c[r[p]]-c[r[p-1]]) for p in range(len(r))])</span></span>
<span id="cb6-173"><a href="#cb6-173" aria-hidden="true" tabindex="-1"></a>path_distance <span class="op">=</span> <span class="kw">lambda</span> r,c: np.<span class="bu">sum</span>([np.linalg.norm(c[r[p<span class="op">+</span><span class="dv">1</span>]]<span class="op">-</span>c[r[p]]) <span class="cf">for</span> p <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(r)<span class="op">-</span><span class="dv">1</span>)])</span>
<span id="cb6-174"><a href="#cb6-174" aria-hidden="true" tabindex="-1"></a><span class="co"># Reverse the order of all elements from element i to element k in array r.</span></span>
<span id="cb6-175"><a href="#cb6-175" aria-hidden="true" tabindex="-1"></a>two_opt_swap <span class="op">=</span> <span class="kw">lambda</span> r,i,k: np.concatenate((r[<span class="dv">0</span>:i],r[k:<span class="op">-</span><span class="bu">len</span>(r)<span class="op">+</span>i<span class="op">-</span><span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>],r[k<span class="op">+</span><span class="dv">1</span>:<span class="bu">len</span>(r)]))</span>
<span id="cb6-176"><a href="#cb6-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-177"><a href="#cb6-177" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> two_opt(cities, improvement_threshold): <span class="co"># 2-opt Algorithm adapted from https://en.wikipedia.org/wiki/2-opt</span></span>
<span id="cb6-178"><a href="#cb6-178" aria-hidden="true" tabindex="-1"></a>    route <span class="op">=</span> np.arange(cities.shape[<span class="dv">0</span>]) <span class="co"># Make an array of row numbers corresponding to cities.</span></span>
<span id="cb6-179"><a href="#cb6-179" aria-hidden="true" tabindex="-1"></a>    improvement_factor <span class="op">=</span> <span class="dv">1</span> <span class="co"># Initialize the improvement factor.</span></span>
<span id="cb6-180"><a href="#cb6-180" aria-hidden="true" tabindex="-1"></a>    best_distance <span class="op">=</span> path_distance(route, cities) <span class="co"># Calculate the distance of the initial path.</span></span>
<span id="cb6-181"><a href="#cb6-181" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> improvement_factor <span class="op">&gt;</span> improvement_threshold: <span class="co"># If the route is still improving, keep going!</span></span>
<span id="cb6-182"><a href="#cb6-182" aria-hidden="true" tabindex="-1"></a>        distance_to_beat <span class="op">=</span> best_distance <span class="co"># Record the distance at the beginning of the loop.</span></span>
<span id="cb6-183"><a href="#cb6-183" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> swap_first <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>,<span class="bu">len</span>(route)<span class="op">-</span><span class="dv">2</span>): <span class="co"># From each city except the first and last,</span></span>
<span id="cb6-184"><a href="#cb6-184" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> swap_last <span class="kw">in</span> <span class="bu">range</span>(swap_first<span class="op">+</span><span class="dv">1</span>,<span class="bu">len</span>(route)): <span class="co"># to each of the cities following,</span></span>
<span id="cb6-185"><a href="#cb6-185" aria-hidden="true" tabindex="-1"></a>                new_route <span class="op">=</span> two_opt_swap(route,swap_first,swap_last) <span class="co"># try reversing the order of these cities</span></span>
<span id="cb6-186"><a href="#cb6-186" aria-hidden="true" tabindex="-1"></a>                new_distance <span class="op">=</span> path_distance(new_route,cities) <span class="co"># and check the total distance with this modification.</span></span>
<span id="cb6-187"><a href="#cb6-187" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> new_distance <span class="op">&lt;</span> best_distance: <span class="co"># If the path distance is an improvement,</span></span>
<span id="cb6-188"><a href="#cb6-188" aria-hidden="true" tabindex="-1"></a>                    route <span class="op">=</span> new_route <span class="co"># make this the accepted best route</span></span>
<span id="cb6-189"><a href="#cb6-189" aria-hidden="true" tabindex="-1"></a>                    best_distance <span class="op">=</span> new_distance <span class="co"># and update the distance corresponding to this route.</span></span>
<span id="cb6-190"><a href="#cb6-190" aria-hidden="true" tabindex="-1"></a>        improvement_factor <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> best_distance<span class="op">/</span>distance_to_beat <span class="co"># Calculate how much the route has improved.</span></span>
<span id="cb6-191"><a href="#cb6-191" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> route <span class="co"># When the route is no longer improving substantially, stop searching and return the route.</span></span>
<span id="cb6-192"><a href="#cb6-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-193"><a href="#cb6-193" aria-hidden="true" tabindex="-1"></a>lat <span class="op">=</span> lat[::<span class="dv">4</span>]</span>
<span id="cb6-194"><a href="#cb6-194" aria-hidden="true" tabindex="-1"></a>lon <span class="op">=</span> lon[::<span class="dv">4</span>]</span>
<span id="cb6-195"><a href="#cb6-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-196"><a href="#cb6-196" aria-hidden="true" tabindex="-1"></a>cities <span class="op">=</span> np.array([lon, lat]).T</span>
<span id="cb6-197"><a href="#cb6-197" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(cities.shape)</span>
<span id="cb6-198"><a href="#cb6-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-199"><a href="#cb6-199" aria-hidden="true" tabindex="-1"></a>route <span class="op">=</span> two_opt(cities, <span class="fl">0.01</span>)</span>
<span id="cb6-200"><a href="#cb6-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-201"><a href="#cb6-201" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb6-202"><a href="#cb6-202" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder the cities matrix by route order in a new matrix for plotting.</span></span>
<span id="cb6-203"><a href="#cb6-203" aria-hidden="true" tabindex="-1"></a><span class="co"># new_cities_order = np.concatenate((np.array([cities[route[i]] for i in range(len(route))]),np.array([cities[0]])))</span></span>
<span id="cb6-204"><a href="#cb6-204" aria-hidden="true" tabindex="-1"></a>new_cities_order <span class="op">=</span> np.array([cities[route[i]] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(route))])</span>
<span id="cb6-205"><a href="#cb6-205" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the cities.</span></span>
<span id="cb6-206"><a href="#cb6-206" aria-hidden="true" tabindex="-1"></a>plt.scatter(cities[:,<span class="dv">0</span>],cities[:,<span class="dv">1</span>])</span>
<span id="cb6-207"><a href="#cb6-207" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the path.</span></span>
<span id="cb6-208"><a href="#cb6-208" aria-hidden="true" tabindex="-1"></a>plt.plot(new_cities_order[:,<span class="dv">0</span>],new_cities_order[:,<span class="dv">1</span>])</span>
<span id="cb6-209"><a href="#cb6-209" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb6-210"><a href="#cb6-210" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb6-211"><a href="#cb6-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-212"><a href="#cb6-212" aria-hidden="true" tabindex="-1"></a>Okay, a bunch of fancy math tricks from SO<span class="ot">[^1][^2]</span> didn't help. But I'm starting to suspect I am seriously overcomplicating this.</span>
<span id="cb6-213"><a href="#cb6-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-214"><a href="#cb6-214" aria-hidden="true" tabindex="-1"></a><span class="ot">[^1]: https://stackoverflow.com/questions/25585401/travelling-salesman-in-scipy</span></span>
<span id="cb6-215"><a href="#cb6-215" aria-hidden="true" tabindex="-1"></a><span class="ot">[^2]: https://gis.stackexchange.com/questions/420940/shortest-path-touching-all-points</span></span>
<span id="cb6-216"><a href="#cb6-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-217"><a href="#cb6-217" aria-hidden="true" tabindex="-1"></a>Let me see.</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">This blog is built with ❤️ and <a href="https://www.quarto.org">Quarto</a> by Fergus Fettes.</div>   
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/FergusFettes">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>



</body></html>