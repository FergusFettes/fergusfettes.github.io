<!DOCTYPE html>
<html lang="en"><head>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/tabby.min.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.2.269">

  <meta name="author" content="Fergus Fettes">
  <title>Fergus Fettes - What can GPT4 do for you?</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../site_libs/revealjs/dist/theme/quarto.css" id="theme">
  <link href="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-captioned.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-captioned) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-captioned.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-captioned .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-captioned .callout-caption  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-captioned.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-captioned.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-caption {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-caption {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-caption {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-captioned .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-captioned .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-captioned) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-caption {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-caption {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-caption {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-caption {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-caption {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">What can GPT4 do for you?</h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Fergus Fettes 
</div>
</div>
</div>

  <p class="date">Oct 21, 2024</p>
</section>
<section id="section" class="slide level2" data-background-size="60%" data-background-position="center" data-background-color="black" data-background-image="../_images/email.png">
<h2></h2>
</section>
<section id="section-1" class="slide level2">
<h2></h2>

<img data-src="../_images/hardware.jpeg" class="r-stretch"></section>
<section id="section-2" class="slide level2">
<h2></h2>
<p><img data-src="../_images/sparks-of-agi.png"></p>
<p>“GPT-4 can solve novel and difficult tasks that span mathematics, coding, vision, medicine, law, psychology and more … strikingly close to human-level performance”<sup>1</sup></p>
<aside><ol class="aside-footnotes"><li id="fn1"><p><a href="https://arxiv.org/pdf/2303.12712.pdf">Sparks of Artificial General Intelligence: Early experiments with GPT-4</a></p></li></ol></aside></section>
<section id="section-3" class="slide level2">
<h2></h2>
<p>“The central claim of our work is that GPT-4 attains a form of general intelligence, indeed showing sparks of artificial general intelligence. This is demonstrated by its core mental capabilities (such as reasoning, creativity, and deduction), its range of topics on which it has gained expertise (such as literature, medicine, and coding), and the variety of tasks it is able to perform (e.g., playing games, using tools, explaining itself, …). A lot remains to be done to create a system that could qualify as a complete AGI.”<sup>1</sup></p>
<aside><ol class="aside-footnotes"><li id="fn2"><p><a href="https://arxiv.org/pdf/2303.12712.pdf">Sparks of Artificial General Intelligence: Early experiments with GPT-4</a></p></li></ol></aside></section>
<section id="and-it-aint-going-nowhere-but-up" class="slide level2">
<h2>And it aint going nowhere but up</h2>

<img data-src="https://www.erichgrunewald.com/img/flop_tai.png" class="r-stretch quarto-figure-center"><p class="caption">assuming 1e35 required for TAI (GPT4 was 3e25)</p></section>
<section id="section-4" class="slide level2">
<h2></h2>
<blockquote>
<p>The point being, it is probably worth learning a bit about this paradigm shift, so when it steamrollers all of us you at least know what is going on</p>
</blockquote>
<p><br>
<br>
<br>
<strong><em>however, on to practicalities</em></strong></p>
</section>
<section id="what-it-does-for-us-doc-bot" class="slide level2" data-background-color="black" data-background-image="https://wallpapercave.com/wp/wp2726672.jpg">
<h2>What it does for us: Doc Bot</h2>

<img data-src="https://clipartcraft.com/images/emoji-clipart-thinking-4.png" class="r-stretch"></section>
<section id="smart-chunking" class="slide level2 smaller">
<h2>‘Smart’ Chunking</h2>
<p>(actually pretty dumb– I’ll come back to this)</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a><span class="co">#!/usr/bin/env python</span></span>
<span id="cb1-2"><a href="#cb1-2"></a></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="im">import</span> json</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb1-5"><a href="#cb1-5"></a></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="im">from</span> gpt_index <span class="im">import</span> LLMPredictor, MockLLMPredictor</span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="im">from</span> gpt_index.indices <span class="im">import</span> GPTTreeIndex</span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="im">from</span> langchain.chains.summarize <span class="im">import</span> load_summarize_chain</span>
<span id="cb1-9"><a href="#cb1-9"></a></span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="im">import</span> click</span>
<span id="cb1-11"><a href="#cb1-11"></a></span>
<span id="cb1-12"><a href="#cb1-12"></a><span class="im">import</span> tiktoken</span>
<span id="cb1-13"><a href="#cb1-13"></a><span class="im">from</span> gpt_index.readers <span class="im">import</span> SimpleDirectoryReader</span>
<span id="cb1-14"><a href="#cb1-14"></a><span class="im">from</span> langchain <span class="im">import</span> OpenAI</span>
<span id="cb1-15"><a href="#cb1-15"></a><span class="im">from</span> langchain.docstore.document <span class="im">import</span> Document</span>
<span id="cb1-16"><a href="#cb1-16"></a><span class="im">from</span> gpt_index.readers.schema.base <span class="im">import</span> Document <span class="im">as</span> GPTDocument</span>
<span id="cb1-17"><a href="#cb1-17"></a><span class="im">from</span> langchain.text_splitter <span class="im">import</span> CharacterTextSplitter, PythonCodeTextSplitter</span>
<span id="cb1-18"><a href="#cb1-18"></a><span class="im">from</span> config <span class="im">import</span> (</span>
<span id="cb1-19"><a href="#cb1-19"></a>    DEFAULT_PYTHON_EXCLUDE,</span>
<span id="cb1-20"><a href="#cb1-20"></a>    MAP_PROMPT,</span>
<span id="cb1-21"><a href="#cb1-21"></a>    COMBINE_PROMPT,</span>
<span id="cb1-22"><a href="#cb1-22"></a>    QUESTION_PROMPT,</span>
<span id="cb1-23"><a href="#cb1-23"></a>    REFINE_PROMPT,</span>
<span id="cb1-24"><a href="#cb1-24"></a>    SUMMARY_PROMPT,</span>
<span id="cb1-25"><a href="#cb1-25"></a>)</span>
<span id="cb1-26"><a href="#cb1-26"></a></span>
<span id="cb1-27"><a href="#cb1-27"></a></span>
<span id="cb1-28"><a href="#cb1-28"></a><span class="kw">def</span> get_excludes(exclude<span class="op">=</span><span class="va">None</span>, exclude_file<span class="op">=</span><span class="st">""</span>):</span>
<span id="cb1-29"><a href="#cb1-29"></a>    <span class="co"># If exclude list provided, use it</span></span>
<span id="cb1-30"><a href="#cb1-30"></a>    <span class="cf">if</span> <span class="bu">isinstance</span>(exclude, <span class="bu">str</span>):</span>
<span id="cb1-31"><a href="#cb1-31"></a>        <span class="cf">return</span> exclude.split(<span class="st">","</span>)</span>
<span id="cb1-32"><a href="#cb1-32"></a></span>
<span id="cb1-33"><a href="#cb1-33"></a>    <span class="co"># If exclude file exists, use it</span></span>
<span id="cb1-34"><a href="#cb1-34"></a>    <span class="cf">if</span> Path(exclude_file).exists() <span class="kw">and</span> Path(exclude_file).is_file():</span>
<span id="cb1-35"><a href="#cb1-35"></a>        click.echo(<span class="ss">f"Using exclude file: </span><span class="sc">{</span>exclude_file<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb1-36"><a href="#cb1-36"></a>        excludes <span class="op">=</span> Path(exclude_file).read_text().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb1-37"><a href="#cb1-37"></a>        drop_paths <span class="op">=</span> [e <span class="cf">for</span> e <span class="kw">in</span> excludes <span class="cf">if</span> e.startswith(<span class="st">"/"</span>)]</span>
<span id="cb1-38"><a href="#cb1-38"></a>        <span class="cf">if</span> drop_paths:</span>
<span id="cb1-39"><a href="#cb1-39"></a>            click.echo(<span class="ss">f"Excluding comments and relative paths from exclude file: </span><span class="sc">{</span>drop_paths<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb1-40"><a href="#cb1-40"></a>        excludes <span class="op">=</span> [e <span class="cf">for</span> e <span class="kw">in</span> excludes <span class="cf">if</span> e <span class="kw">and</span> <span class="kw">not</span> e.startswith(<span class="st">"#"</span>) <span class="kw">and</span> <span class="kw">not</span> e.startswith(<span class="st">"/"</span>)]</span>
<span id="cb1-41"><a href="#cb1-41"></a>        <span class="cf">return</span> excludes</span>
<span id="cb1-42"><a href="#cb1-42"></a></span>
<span id="cb1-43"><a href="#cb1-43"></a>    <span class="co"># Otherwise, use default</span></span>
<span id="cb1-44"><a href="#cb1-44"></a>    <span class="cf">return</span> DEFAULT_PYTHON_EXCLUDE</span>
<span id="cb1-45"><a href="#cb1-45"></a></span>
<span id="cb1-46"><a href="#cb1-46"></a></span>
<span id="cb1-47"><a href="#cb1-47"></a><span class="kw">def</span> get_includes(include<span class="op">=</span><span class="va">None</span>, include_file<span class="op">=</span><span class="st">""</span>):</span>
<span id="cb1-48"><a href="#cb1-48"></a>    <span class="co"># If include list provided, use it</span></span>
<span id="cb1-49"><a href="#cb1-49"></a>    <span class="cf">if</span> <span class="bu">isinstance</span>(include, <span class="bu">str</span>):</span>
<span id="cb1-50"><a href="#cb1-50"></a>        <span class="cf">return</span> include.split(<span class="st">","</span>)</span>
<span id="cb1-51"><a href="#cb1-51"></a></span>
<span id="cb1-52"><a href="#cb1-52"></a>    <span class="co"># If include file exists, use it</span></span>
<span id="cb1-53"><a href="#cb1-53"></a>    <span class="cf">if</span> include_file <span class="kw">and</span> Path(include_file).exists():</span>
<span id="cb1-54"><a href="#cb1-54"></a>        click.echo(<span class="ss">f"Using include file: </span><span class="sc">{</span>include_file<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb1-55"><a href="#cb1-55"></a>        includes <span class="op">=</span> Path(include_file).read_text().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb1-56"><a href="#cb1-56"></a>        <span class="cf">return</span> includes</span>
<span id="cb1-57"><a href="#cb1-57"></a></span>
<span id="cb1-58"><a href="#cb1-58"></a>    <span class="co"># Otherwise, use default</span></span>
<span id="cb1-59"><a href="#cb1-59"></a>    <span class="cf">return</span> []</span>
<span id="cb1-60"><a href="#cb1-60"></a></span>
<span id="cb1-61"><a href="#cb1-61"></a></span>
<span id="cb1-62"><a href="#cb1-62"></a><span class="kw">def</span> get_reader(path, exclude<span class="op">=</span><span class="va">None</span>, include<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb1-63"><a href="#cb1-63"></a>    <span class="cf">return</span> SimpleDirectoryReader(</span>
<span id="cb1-64"><a href="#cb1-64"></a>        <span class="bu">str</span>(path),</span>
<span id="cb1-65"><a href="#cb1-65"></a>        exclude<span class="op">=</span>exclude,</span>
<span id="cb1-66"><a href="#cb1-66"></a>        include<span class="op">=</span>include,</span>
<span id="cb1-67"><a href="#cb1-67"></a>        exclude_hidden<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb1-68"><a href="#cb1-68"></a>        recursive<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb1-69"><a href="#cb1-69"></a>    )</span>
<span id="cb1-70"><a href="#cb1-70"></a></span>
<span id="cb1-71"><a href="#cb1-71"></a></span>
<span id="cb1-72"><a href="#cb1-72"></a><span class="kw">def</span> get_files(reader, model):</span>
<span id="cb1-73"><a href="#cb1-73"></a>    files <span class="op">=</span> reader.input_files</span>
<span id="cb1-74"><a href="#cb1-74"></a>    total_cost <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb1-75"><a href="#cb1-75"></a>    files_str <span class="op">=</span> <span class="st">""</span></span>
<span id="cb1-76"><a href="#cb1-76"></a>    <span class="cf">for</span> <span class="bu">file</span> <span class="kw">in</span> files:</span>
<span id="cb1-77"><a href="#cb1-77"></a>        files_str <span class="op">+=</span> <span class="st">"</span><span class="ch">\n</span><span class="st">- "</span></span>
<span id="cb1-78"><a href="#cb1-78"></a>        <span class="cf">try</span>:</span>
<span id="cb1-79"><a href="#cb1-79"></a>            text <span class="op">=</span> <span class="bu">file</span>.read_text()</span>
<span id="cb1-80"><a href="#cb1-80"></a>        <span class="cf">except</span> <span class="pp">UnicodeDecodeError</span>:</span>
<span id="cb1-81"><a href="#cb1-81"></a>            files_str <span class="op">+=</span> <span class="ss">f"</span><span class="sc">{</span><span class="bu">file</span><span class="sc">}</span><span class="ss"> (BINARY! SKIP THIS ONE!)"</span></span>
<span id="cb1-82"><a href="#cb1-82"></a>            <span class="cf">continue</span></span>
<span id="cb1-83"><a href="#cb1-83"></a>        size <span class="op">=</span> <span class="bu">len</span>(get_encoding(model).encode(text))</span>
<span id="cb1-84"><a href="#cb1-84"></a>        files_str <span class="op">+=</span> <span class="ss">f"</span><span class="sc">{</span><span class="bu">file</span><span class="sc">}</span><span class="ch">\t\t</span><span class="ss">(</span><span class="sc">{</span>size<span class="sc">}</span><span class="ss"> tokens, "</span></span>
<span id="cb1-85"><a href="#cb1-85"></a>        cost <span class="op">=</span> get_text_cost(model, text)</span>
<span id="cb1-86"><a href="#cb1-86"></a>        total_cost <span class="op">+=</span> cost</span>
<span id="cb1-87"><a href="#cb1-87"></a>        files_str <span class="op">+=</span> <span class="ss">f"</span><span class="ch">\t</span><span class="sc">{</span>cost<span class="sc">:.2f}</span><span class="ss"> USD)"</span></span>
<span id="cb1-88"><a href="#cb1-88"></a>        </span>
<span id="cb1-89"><a href="#cb1-89"></a>    click.echo(<span class="ss">f"Found: </span><span class="sc">{</span><span class="bu">len</span>(reader.input_files)<span class="sc">}</span><span class="ss"> files: </span><span class="sc">{</span>files_str<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb1-90"><a href="#cb1-90"></a>    click.echo(<span class="ss">f"Total INGOING cost: </span><span class="sc">{</span>total_cost<span class="sc">:.2f}</span><span class="ss"> USD, total cost might be 50% more than that, unless you are using the 'refine' method, which could be a lot more."</span>)</span>
<span id="cb1-91"><a href="#cb1-91"></a>    click.confirm(<span class="st">"Continue? Otherwise, try adding exclusion globs."</span>, abort<span class="op">=</span><span class="va">True</span>, default<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb1-92"><a href="#cb1-92"></a>    <span class="cf">return</span> files</span>
<span id="cb1-93"><a href="#cb1-93"></a></span>
<span id="cb1-94"><a href="#cb1-94"></a></span>
<span id="cb1-95"><a href="#cb1-95"></a><span class="kw">def</span> get_text_cost(model, text):</span>
<span id="cb1-96"><a href="#cb1-96"></a>    model_cost_per_token <span class="op">=</span> {</span>
<span id="cb1-97"><a href="#cb1-97"></a>        <span class="st">"gpt-4"</span>: {<span class="st">"prompt"</span>: <span class="fl">0.03</span> <span class="op">/</span> <span class="dv">1000</span>, <span class="st">"completion"</span>: <span class="fl">0.06</span> <span class="op">/</span> <span class="dv">1000</span>},</span>
<span id="cb1-98"><a href="#cb1-98"></a>        <span class="st">"gpt-4-32k"</span>: {<span class="st">"prompt"</span>: <span class="fl">0.06</span> <span class="op">/</span> <span class="dv">1000</span>, <span class="st">"completion"</span>: <span class="fl">0.012</span> <span class="op">/</span> <span class="dv">1000</span>},</span>
<span id="cb1-99"><a href="#cb1-99"></a>        <span class="st">"gpt-3.5-turbo"</span>: {<span class="st">"prompt"</span>: <span class="fl">0.002</span> <span class="op">/</span> <span class="dv">1000</span>, <span class="st">"completion"</span>: <span class="fl">0.002</span> <span class="op">/</span> <span class="dv">1000</span>},</span>
<span id="cb1-100"><a href="#cb1-100"></a>    }</span>
<span id="cb1-101"><a href="#cb1-101"></a>    cost_per_token <span class="op">=</span> model_cost_per_token[model]</span>
<span id="cb1-102"><a href="#cb1-102"></a>    encoding <span class="op">=</span> get_encoding(model)</span>
<span id="cb1-103"><a href="#cb1-103"></a></span>
<span id="cb1-104"><a href="#cb1-104"></a>    size <span class="op">=</span> <span class="bu">len</span>(encoding.encode(text))</span>
<span id="cb1-105"><a href="#cb1-105"></a>    cost <span class="op">=</span> size <span class="op">*</span> cost_per_token[<span class="st">"prompt"</span>]</span>
<span id="cb1-106"><a href="#cb1-106"></a>    <span class="cf">return</span> cost</span>
<span id="cb1-107"><a href="#cb1-107"></a></span>
<span id="cb1-108"><a href="#cb1-108"></a></span>
<span id="cb1-109"><a href="#cb1-109"></a><span class="kw">def</span> get_output(path, output):</span>
<span id="cb1-110"><a href="#cb1-110"></a>    <span class="cf">if</span> <span class="kw">not</span> output:</span>
<span id="cb1-111"><a href="#cb1-111"></a>        output <span class="op">=</span> path.replace(<span class="st">"/"</span>, <span class="st">"_"</span>).replace(<span class="st">"."</span>, <span class="st">"_"</span>)</span>
<span id="cb1-112"><a href="#cb1-112"></a>        click.echo(<span class="ss">f"Output not specified, using: </span><span class="sc">{</span>output<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb1-113"><a href="#cb1-113"></a>        click.confirm(<span class="st">"Continue?"</span>, abort<span class="op">=</span><span class="va">True</span>, default<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb1-114"><a href="#cb1-114"></a>    <span class="cf">else</span>:</span>
<span id="cb1-115"><a href="#cb1-115"></a>        click.echo(<span class="ss">f"Output specified: </span><span class="sc">{</span>output<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb1-116"><a href="#cb1-116"></a>    output <span class="op">=</span> Path(output)</span>
<span id="cb1-117"><a href="#cb1-117"></a>    output.parent.mkdir(parents<span class="op">=</span><span class="va">True</span>, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb1-118"><a href="#cb1-118"></a>    <span class="cf">return</span> output</span>
<span id="cb1-119"><a href="#cb1-119"></a></span>
<span id="cb1-120"><a href="#cb1-120"></a></span>
<span id="cb1-121"><a href="#cb1-121"></a><span class="kw">def</span> get_encoding(model):</span>
<span id="cb1-122"><a href="#cb1-122"></a>    <span class="cf">try</span>:</span>
<span id="cb1-123"><a href="#cb1-123"></a>        encoding <span class="op">=</span> tiktoken.encoding_for_model(model)</span>
<span id="cb1-124"><a href="#cb1-124"></a>    <span class="cf">except</span> <span class="pp">KeyError</span>:</span>
<span id="cb1-125"><a href="#cb1-125"></a>        encoding <span class="op">=</span> tiktoken.get_encoding(<span class="st">"gpt2"</span>)</span>
<span id="cb1-126"><a href="#cb1-126"></a>    <span class="cf">return</span> encoding</span>
<span id="cb1-127"><a href="#cb1-127"></a></span>
<span id="cb1-128"><a href="#cb1-128"></a></span>
<span id="cb1-129"><a href="#cb1-129"></a><span class="kw">def</span> get_docs(files, chunk_size):</span>
<span id="cb1-130"><a href="#cb1-130"></a>    docs <span class="op">=</span> []</span>
<span id="cb1-131"><a href="#cb1-131"></a>    <span class="cf">for</span> <span class="bu">file</span> <span class="kw">in</span> files:</span>
<span id="cb1-132"><a href="#cb1-132"></a>        <span class="co"># If its a python file</span></span>
<span id="cb1-133"><a href="#cb1-133"></a>        <span class="cf">if</span> <span class="bu">file</span>.suffix <span class="op">==</span> <span class="st">".py"</span>:</span>
<span id="cb1-134"><a href="#cb1-134"></a>            text_splitter <span class="op">=</span> PythonCodeTextSplitter()</span>
<span id="cb1-135"><a href="#cb1-135"></a>        <span class="cf">else</span>: </span>
<span id="cb1-136"><a href="#cb1-136"></a>            text_splitter <span class="op">=</span> CharacterTextSplitter()</span>
<span id="cb1-137"><a href="#cb1-137"></a>        text_splitter._chunk_size <span class="op">=</span> chunk_size</span>
<span id="cb1-138"><a href="#cb1-138"></a>        texts <span class="op">=</span> text_splitter.split_text(<span class="bu">file</span>.read_text())</span>
<span id="cb1-139"><a href="#cb1-139"></a>        <span class="cf">for</span> t <span class="kw">in</span> texts:</span>
<span id="cb1-140"><a href="#cb1-140"></a>            docs.append(Document(page_content<span class="op">=</span>t, metadata<span class="op">=</span>{<span class="st">"file_path"</span>: <span class="bu">file</span>}))</span>
<span id="cb1-141"><a href="#cb1-141"></a>    <span class="cf">return</span> docs</span>
<span id="cb1-142"><a href="#cb1-142"></a></span>
<span id="cb1-143"><a href="#cb1-143"></a></span>
<span id="cb1-144"><a href="#cb1-144"></a><span class="kw">def</span> lc_summarize(docs, method, llm<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb1-145"><a href="#cb1-145"></a>    chain <span class="op">=</span> _refine_chain(llm) <span class="cf">if</span> method <span class="op">==</span> <span class="st">"refine"</span> <span class="cf">else</span> _map_reduce_chain(llm)</span>
<span id="cb1-146"><a href="#cb1-146"></a>    results <span class="op">=</span> chain({<span class="st">"input_documents"</span>: docs}, return_only_outputs<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb1-147"><a href="#cb1-147"></a>    results[<span class="st">"input_documents"</span>] <span class="op">=</span> [d.page_content <span class="cf">for</span> d <span class="kw">in</span> docs]</span>
<span id="cb1-148"><a href="#cb1-148"></a>    <span class="cf">return</span> results</span>
<span id="cb1-149"><a href="#cb1-149"></a></span>
<span id="cb1-150"><a href="#cb1-150"></a></span>
<span id="cb1-151"><a href="#cb1-151"></a><span class="kw">def</span> _refine_chain(llm):</span>
<span id="cb1-152"><a href="#cb1-152"></a>    <span class="cf">return</span> load_summarize_chain(</span>
<span id="cb1-153"><a href="#cb1-153"></a>        llm,</span>
<span id="cb1-154"><a href="#cb1-154"></a>        chain_type<span class="op">=</span><span class="st">"refine"</span>,</span>
<span id="cb1-155"><a href="#cb1-155"></a>        question_prompt<span class="op">=</span>QUESTION_PROMPT,</span>
<span id="cb1-156"><a href="#cb1-156"></a>        refine_prompt<span class="op">=</span>REFINE_PROMPT,</span>
<span id="cb1-157"><a href="#cb1-157"></a>        verbose<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb1-158"><a href="#cb1-158"></a>        return_intermediate_steps<span class="op">=</span><span class="va">True</span></span>
<span id="cb1-159"><a href="#cb1-159"></a>    )</span>
<span id="cb1-160"><a href="#cb1-160"></a></span>
<span id="cb1-161"><a href="#cb1-161"></a></span>
<span id="cb1-162"><a href="#cb1-162"></a><span class="kw">def</span> _map_reduce_chain(llm):</span>
<span id="cb1-163"><a href="#cb1-163"></a>    <span class="cf">return</span> load_summarize_chain(</span>
<span id="cb1-164"><a href="#cb1-164"></a>        llm,</span>
<span id="cb1-165"><a href="#cb1-165"></a>        chain_type<span class="op">=</span><span class="st">"map_reduce"</span>,</span>
<span id="cb1-166"><a href="#cb1-166"></a>        map_prompt<span class="op">=</span>MAP_PROMPT,</span>
<span id="cb1-167"><a href="#cb1-167"></a>        combine_prompt<span class="op">=</span>COMBINE_PROMPT,</span>
<span id="cb1-168"><a href="#cb1-168"></a>        verbose<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb1-169"><a href="#cb1-169"></a>        return_intermediate_steps<span class="op">=</span><span class="va">True</span></span>
<span id="cb1-170"><a href="#cb1-170"></a>    )</span>
<span id="cb1-171"><a href="#cb1-171"></a></span>
<span id="cb1-172"><a href="#cb1-172"></a></span>
<span id="cb1-173"><a href="#cb1-173"></a><span class="kw">def</span> langchain_format(docs, results, files, output, method):</span>
<span id="cb1-174"><a href="#cb1-174"></a>    output.mkdir(parents<span class="op">=</span><span class="va">True</span>, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb1-175"><a href="#cb1-175"></a>    (output <span class="op">/</span> <span class="ss">f"</span><span class="sc">{</span>method<span class="sc">}</span><span class="ss">_output.json"</span>).write_text(json.dumps(results, indent<span class="op">=</span><span class="dv">2</span>))</span>
<span id="cb1-176"><a href="#cb1-176"></a></span>
<span id="cb1-177"><a href="#cb1-177"></a>    clean_output <span class="op">=</span> output <span class="op">/</span> <span class="ss">f"</span><span class="sc">{</span>method<span class="sc">}</span><span class="ss">.md"</span></span>
<span id="cb1-178"><a href="#cb1-178"></a>    <span class="cf">with</span> <span class="bu">open</span>(clean_output, <span class="st">"a"</span>) <span class="im">as</span> f:</span>
<span id="cb1-179"><a href="#cb1-179"></a>        f.write(<span class="st">"# Executive Summary</span><span class="ch">\n\n</span><span class="st">- "</span>)</span>
<span id="cb1-180"><a href="#cb1-180"></a>        f.write(<span class="st">"</span><span class="ch">\n</span><span class="st">- "</span>.join([<span class="bu">str</span>(f) <span class="cf">for</span> f <span class="kw">in</span> files]))</span>
<span id="cb1-181"><a href="#cb1-181"></a>        f.write(<span class="ss">f"</span><span class="ch">\n\n</span><span class="sc">{</span>results[<span class="st">'output_text'</span>]<span class="sc">}</span><span class="ch">\n\n</span><span class="ss">"</span>)</span>
<span id="cb1-182"><a href="#cb1-182"></a>        f.write(<span class="st">"# Intermediate Summaries</span><span class="ch">\n\n</span><span class="st">"</span>)</span>
<span id="cb1-183"><a href="#cb1-183"></a>        <span class="cf">for</span> doc, summary <span class="kw">in</span> <span class="bu">zip</span>(docs, results[<span class="st">"intermediate_steps"</span>]):</span>
<span id="cb1-184"><a href="#cb1-184"></a>            docstart <span class="op">=</span> doc.summary.split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)[<span class="dv">0</span>]</span>
<span id="cb1-185"><a href="#cb1-185"></a>            docsize <span class="op">=</span> <span class="bu">len</span>(doc.page_content)</span>
<span id="cb1-186"><a href="#cb1-186"></a>            doclines <span class="op">=</span> <span class="bu">len</span>(doc.page_content.split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>))</span>
<span id="cb1-187"><a href="#cb1-187"></a>            <span class="bu">file</span> <span class="op">=</span> doc.metadata[<span class="st">"file_path"</span>]</span>
<span id="cb1-188"><a href="#cb1-188"></a>            f.write(<span class="ss">f"## </span><span class="sc">{</span>docstart<span class="sc">}</span><span class="ss"> (</span><span class="sc">{</span>docsize<span class="sc">}</span><span class="ss"> characters, </span><span class="sc">{</span>doclines<span class="sc">}</span><span class="ss"> lines) from </span><span class="sc">{</span><span class="bu">file</span><span class="sc">}</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb1-189"><a href="#cb1-189"></a>            f.write(<span class="ss">f"</span><span class="sc">{</span>summary<span class="sc">}</span><span class="ch">\n\n</span><span class="ss">"</span>)</span>
<span id="cb1-190"><a href="#cb1-190"></a></span>
<span id="cb1-191"><a href="#cb1-191"></a></span>
<span id="cb1-192"><a href="#cb1-192"></a><span class="kw">def</span> tree_index(reader, llm<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb1-193"><a href="#cb1-193"></a>    docs <span class="op">=</span> reader.load_data()</span>
<span id="cb1-194"><a href="#cb1-194"></a>    llm_predictor <span class="op">=</span> LLMPredictor(llm) <span class="cf">if</span> llm <span class="cf">else</span> MockLLMPredictor()</span>
<span id="cb1-195"><a href="#cb1-195"></a>    <span class="cf">return</span> GPTTreeIndex(</span>
<span id="cb1-196"><a href="#cb1-196"></a>        docs,</span>
<span id="cb1-197"><a href="#cb1-197"></a>        num_children<span class="op">=</span><span class="dv">3</span>,</span>
<span id="cb1-198"><a href="#cb1-198"></a>        num_roots<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb1-199"><a href="#cb1-199"></a>        summary_template<span class="op">=</span>SUMMARY_PROMPT,</span>
<span id="cb1-200"><a href="#cb1-200"></a>        llm_predictor<span class="op">=</span>llm_predictor,</span>
<span id="cb1-201"><a href="#cb1-201"></a>        text_splitter<span class="op">=</span>PythonCodeTextSplitter(chunk_size<span class="op">=</span><span class="dv">3000</span>)</span>
<span id="cb1-202"><a href="#cb1-202"></a>    )</span>
<span id="cb1-203"><a href="#cb1-203"></a></span>
<span id="cb1-204"><a href="#cb1-204"></a></span>
<span id="cb1-205"><a href="#cb1-205"></a><span class="kw">def</span> tree_format(index, output):</span>
<span id="cb1-206"><a href="#cb1-206"></a>    output.mkdir(parents<span class="op">=</span><span class="va">True</span>, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb1-207"><a href="#cb1-207"></a>    index.save_to_disk(output <span class="op">/</span> <span class="st">"tree_output.json"</span>)</span>
<span id="cb1-208"><a href="#cb1-208"></a></span>
<span id="cb1-209"><a href="#cb1-209"></a>    roots <span class="op">=</span> index.index_struct.root_nodes</span>
<span id="cb1-210"><a href="#cb1-210"></a>    clean_output <span class="op">=</span> output <span class="op">/</span> <span class="ss">f"tree.md"</span></span>
<span id="cb1-211"><a href="#cb1-211"></a>    <span class="cf">with</span> <span class="bu">open</span>(clean_output, <span class="st">"a"</span>) <span class="im">as</span> f:</span>
<span id="cb1-212"><a href="#cb1-212"></a>        print_tier(roots, f, <span class="dv">0</span>, index)</span>
<span id="cb1-213"><a href="#cb1-213"></a></span>
<span id="cb1-214"><a href="#cb1-214"></a></span>
<span id="cb1-215"><a href="#cb1-215"></a><span class="kw">def</span> get_extra_info_from_leafs(node, index):</span>
<span id="cb1-216"><a href="#cb1-216"></a>    leaves <span class="op">=</span> index.index_struct.get_leaves(node)</span>
<span id="cb1-217"><a href="#cb1-217"></a>    extra_info <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb1-218"><a href="#cb1-218"></a>    <span class="cf">for</span> leaf <span class="kw">in</span> leaves.values():</span>
<span id="cb1-219"><a href="#cb1-219"></a>        extra_info.add(leaf.extra_info[<span class="st">'filepath'</span>])</span>
<span id="cb1-220"><a href="#cb1-220"></a>    <span class="cf">return</span> extra_info</span>
<span id="cb1-221"><a href="#cb1-221"></a>        </span>
<span id="cb1-222"><a href="#cb1-222"></a></span>
<span id="cb1-223"><a href="#cb1-223"></a><span class="kw">def</span> print_tier(nodes, f, count, index):</span>
<span id="cb1-224"><a href="#cb1-224"></a>    children <span class="op">=</span> {}</span>
<span id="cb1-225"><a href="#cb1-225"></a>    <span class="cf">for</span> node <span class="kw">in</span> nodes.values():</span>
<span id="cb1-226"><a href="#cb1-226"></a>        children.update(index.index_struct.get_children(node))</span>
<span id="cb1-227"><a href="#cb1-227"></a>    <span class="cf">if</span> <span class="bu">len</span>(children) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb1-228"><a href="#cb1-228"></a>        <span class="cf">return</span></span>
<span id="cb1-229"><a href="#cb1-229"></a>    <span class="cf">if</span> count <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb1-230"><a href="#cb1-230"></a>        f.write(<span class="st">"# Executive Summary</span><span class="ch">\n\n</span><span class="st">"</span>)</span>
<span id="cb1-231"><a href="#cb1-231"></a>    <span class="cf">else</span>:</span>
<span id="cb1-232"><a href="#cb1-232"></a>        f.write(<span class="ss">f"## Level N-</span><span class="sc">{</span>count<span class="sc">}</span><span class="ss"> Summary</span><span class="ch">\n\n</span><span class="ss">"</span>)</span>
<span id="cb1-233"><a href="#cb1-233"></a>    <span class="cf">for</span> i, node <span class="kw">in</span> <span class="bu">enumerate</span>(nodes.values()):</span>
<span id="cb1-234"><a href="#cb1-234"></a>        info <span class="op">=</span> get_extra_info_from_leafs(node, index)</span>
<span id="cb1-235"><a href="#cb1-235"></a>        f.write(<span class="ss">f"### Pt. </span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">, Summary of</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb1-236"><a href="#cb1-236"></a>        f.write(<span class="st">"- "</span> <span class="op">+</span> <span class="st">"</span><span class="ch">\n</span><span class="st">- "</span>.join(info) <span class="op">+</span> <span class="st">"</span><span class="ch">\n\n</span><span class="st">"</span>)</span>
<span id="cb1-237"><a href="#cb1-237"></a>        f.write(<span class="ss">f"</span><span class="sc">{</span>node<span class="sc">.</span>text<span class="sc">}</span><span class="ch">\n\n</span><span class="ss">"</span>)</span>
<span id="cb1-238"><a href="#cb1-238"></a>    print_tier(children, f, count<span class="op">+</span><span class="dv">1</span>, index)</span>
<span id="cb1-239"><a href="#cb1-239"></a></span>
<span id="cb1-240"><a href="#cb1-240"></a></span>
<span id="cb1-241"><a href="#cb1-241"></a><span class="at">@click.command</span>()</span>
<span id="cb1-242"><a href="#cb1-242"></a><span class="at">@click.option</span>(<span class="st">"--path"</span>, <span class="st">"-p"</span>, default<span class="op">=</span><span class="st">"."</span>, <span class="bu">help</span><span class="op">=</span><span class="st">"Path to directory to load."</span>)</span>
<span id="cb1-243"><a href="#cb1-243"></a><span class="at">@click.option</span>(<span class="st">"--gpt_4"</span>, <span class="st">"-g4"</span>, is_flag<span class="op">=</span><span class="va">True</span>, default<span class="op">=</span><span class="va">False</span>, <span class="bu">help</span><span class="op">=</span><span class="st">"Use GPT-4 instead of GPT-3.5."</span>)</span>
<span id="cb1-244"><a href="#cb1-244"></a><span class="at">@click.option</span>(<span class="st">"--exclude"</span>, <span class="st">"-x"</span>, default<span class="op">=</span><span class="va">None</span>, <span class="bu">help</span><span class="op">=</span><span class="st">"Exclude files matching this pattern. (Csv of globs.)"</span>)</span>
<span id="cb1-245"><a href="#cb1-245"></a><span class="at">@click.option</span>(<span class="st">"--include"</span>, <span class="st">"-i"</span>, default<span class="op">=</span><span class="va">None</span>, <span class="bu">help</span><span class="op">=</span><span class="st">"Include list-- overrides excludes."</span>)</span>
<span id="cb1-246"><a href="#cb1-246"></a><span class="at">@click.option</span>(<span class="st">"--exclude_file"</span>, <span class="st">"-X"</span>, default<span class="op">=</span><span class="st">'.gitignore'</span>, <span class="bu">help</span><span class="op">=</span><span class="st">"Exlude files matching these patterns (aka from a .gitignore)"</span>)</span>
<span id="cb1-247"><a href="#cb1-247"></a><span class="at">@click.option</span>(<span class="st">"--output"</span>, <span class="st">"-o"</span>, default<span class="op">=</span><span class="va">None</span>, <span class="bu">help</span><span class="op">=</span><span class="st">"Output file."</span>)</span>
<span id="cb1-248"><a href="#cb1-248"></a><span class="at">@click.option</span>(<span class="st">"--chunk_size"</span>, <span class="st">"-c"</span>, default<span class="op">=</span><span class="dv">3000</span>, <span class="bu">help</span><span class="op">=</span><span class="st">"Maximum size of each chunk."</span>)</span>
<span id="cb1-249"><a href="#cb1-249"></a><span class="at">@click.option</span>(<span class="st">"--method"</span>, <span class="st">"-m"</span>, default<span class="op">=</span><span class="st">"map_reduce"</span>, <span class="bu">help</span><span class="op">=</span><span class="st">"Method to use."</span>, <span class="bu">type</span><span class="op">=</span>click.Choice([<span class="st">"map_reduce"</span>, <span class="st">"refine"</span>, <span class="st">"tree"</span>]))</span>
<span id="cb1-250"><a href="#cb1-250"></a><span class="kw">def</span> main(path, gpt_4, exclude, include, exclude_file, output, chunk_size, method):</span>
<span id="cb1-251"><a href="#cb1-251"></a>    model <span class="op">=</span> <span class="st">"gpt-3.5-turbo"</span> <span class="cf">if</span> <span class="kw">not</span> gpt_4 <span class="cf">else</span> <span class="st">"gpt-4"</span></span>
<span id="cb1-252"><a href="#cb1-252"></a>    chunk_size <span class="op">=</span> chunk_size <span class="cf">if</span> <span class="kw">not</span> gpt_4 <span class="cf">else</span> chunk_size <span class="op">*</span> <span class="dv">2</span></span>
<span id="cb1-253"><a href="#cb1-253"></a></span>
<span id="cb1-254"><a href="#cb1-254"></a>    exclude <span class="op">=</span> get_excludes(exclude, exclude_file)</span>
<span id="cb1-255"><a href="#cb1-255"></a>    include <span class="op">=</span> get_includes(include)</span>
<span id="cb1-256"><a href="#cb1-256"></a>    reader <span class="op">=</span> get_reader(path, exclude, include)</span>
<span id="cb1-257"><a href="#cb1-257"></a>    files <span class="op">=</span> get_files(reader, model)</span>
<span id="cb1-258"><a href="#cb1-258"></a>    output <span class="op">=</span> get_output(path, output)</span>
<span id="cb1-259"><a href="#cb1-259"></a></span>
<span id="cb1-260"><a href="#cb1-260"></a>    llm <span class="op">=</span> OpenAI(temperature<span class="op">=</span><span class="dv">0</span>, model<span class="op">=</span>model, max_tokens<span class="op">=</span><span class="dv">1000</span>)</span>
<span id="cb1-261"><a href="#cb1-261"></a></span>
<span id="cb1-262"><a href="#cb1-262"></a>    <span class="cf">if</span> method <span class="kw">in</span> [<span class="st">"map_reduce"</span>, <span class="st">"refine"</span>]:</span>
<span id="cb1-263"><a href="#cb1-263"></a>        docs <span class="op">=</span> get_docs(files, chunk_size)</span>
<span id="cb1-264"><a href="#cb1-264"></a>        results <span class="op">=</span> lc_summarize(docs, method, llm)</span>
<span id="cb1-265"><a href="#cb1-265"></a>        langchain_format(docs, results, files, output, method)</span>
<span id="cb1-266"><a href="#cb1-266"></a>    <span class="cf">elif</span> method <span class="op">==</span> <span class="st">"tree"</span>:</span>
<span id="cb1-267"><a href="#cb1-267"></a>        index <span class="op">=</span> tree_index(reader, llm)</span>
<span id="cb1-268"><a href="#cb1-268"></a>        tree_format(index, output)</span>
<span id="cb1-269"><a href="#cb1-269"></a></span>
<span id="cb1-270"><a href="#cb1-270"></a></span>
<span id="cb1-271"><a href="#cb1-271"></a></span>
<span id="cb1-272"><a href="#cb1-272"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">"__main__"</span>:</span>
<span id="cb1-273"><a href="#cb1-273"></a>    main()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="prompting" class="slide level2 smaller">
<h2>Prompting</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1"></a><span class="im">import</span> logging</span>
<span id="cb2-2"><a href="#cb2-2"></a></span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="im">from</span> gpt_index.prompts.prompts <span class="im">import</span> SummaryPrompt</span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="im">from</span> langchain <span class="im">import</span> PromptTemplate</span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="im">from</span> dotenv <span class="im">import</span> load_dotenv</span>
<span id="cb2-6"><a href="#cb2-6"></a></span>
<span id="cb2-7"><a href="#cb2-7"></a>load_dotenv()</span>
<span id="cb2-8"><a href="#cb2-8"></a></span>
<span id="cb2-9"><a href="#cb2-9"></a>logging.basicConfig(</span>
<span id="cb2-10"><a href="#cb2-10"></a>    <span class="bu">format</span><span class="op">=</span><span class="st">"</span><span class="sc">%(asctime)s</span><span class="st"> - </span><span class="sc">%(levelname)s</span><span class="st"> - </span><span class="sc">%(message)s</span><span class="st">"</span>,</span>
<span id="cb2-11"><a href="#cb2-11"></a>    datefmt<span class="op">=</span><span class="st">"%Y-%m-</span><span class="sc">%d</span><span class="st"> %H:%M:%S"</span>,</span>
<span id="cb2-12"><a href="#cb2-12"></a>    level<span class="op">=</span>logging.INFO,</span>
<span id="cb2-13"><a href="#cb2-13"></a>)</span>
<span id="cb2-14"><a href="#cb2-14"></a>logger <span class="op">=</span> logging.getLogger()</span>
<span id="cb2-15"><a href="#cb2-15"></a></span>
<span id="cb2-16"><a href="#cb2-16"></a></span>
<span id="cb2-17"><a href="#cb2-17"></a>DEFAULT_PYTHON_EXCLUDE <span class="op">=</span> [</span>
<span id="cb2-18"><a href="#cb2-18"></a>    <span class="st">"**/_static/**/*"</span>,</span>
<span id="cb2-19"><a href="#cb2-19"></a>    <span class="st">"**/.git/**/*"</span>,</span>
<span id="cb2-20"><a href="#cb2-20"></a>    <span class="st">"**/__pycache__/**/*"</span>,</span>
<span id="cb2-21"><a href="#cb2-21"></a>    <span class="st">"**/tk_*/**/*"</span>,</span>
<span id="cb2-22"><a href="#cb2-22"></a>    <span class="st">"__init__.py"</span>,</span>
<span id="cb2-23"><a href="#cb2-23"></a>    <span class="st">"poetry.lock"</span>,</span>
<span id="cb2-24"><a href="#cb2-24"></a>    <span class="st">"*.txt"</span>,</span>
<span id="cb2-25"><a href="#cb2-25"></a>    <span class="st">"*.ini"</span>,</span>
<span id="cb2-26"><a href="#cb2-26"></a>    <span class="st">"*.json"</span>,</span>
<span id="cb2-27"><a href="#cb2-27"></a>    <span class="st">"*.html"</span>,</span>
<span id="cb2-28"><a href="#cb2-28"></a>    <span class="st">"*.md"</span>,</span>
<span id="cb2-29"><a href="#cb2-29"></a>    <span class="st">"**/_*/**/*"</span>,</span>
<span id="cb2-30"><a href="#cb2-30"></a>]</span>
<span id="cb2-31"><a href="#cb2-31"></a></span>
<span id="cb2-32"><a href="#cb2-32"></a></span>
<span id="cb2-33"><a href="#cb2-33"></a><span class="co">## Prompts for Map</span></span>
<span id="cb2-34"><a href="#cb2-34"></a></span>
<span id="cb2-35"><a href="#cb2-35"></a>prompt_template <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb2-36"><a href="#cb2-36"></a><span class="st">Explain the following code exhaustively in English, including details that will be useful for later iterations to combine summaries, to inderstand the whole repository. If there are important errors in the code or TODOs, please point them out and comment on them. You can extract individual lines in code blocks.</span></span>
<span id="cb2-37"><a href="#cb2-37"></a></span>
<span id="cb2-38"><a href="#cb2-38"></a><span class="st">==CODE==</span></span>
<span id="cb2-39"><a href="#cb2-39"></a><span class="sc">{text}</span></span>
<span id="cb2-40"><a href="#cb2-40"></a></span>
<span id="cb2-41"><a href="#cb2-41"></a><span class="st">==SUMMARY==</span></span>
<span id="cb2-42"><a href="#cb2-42"></a><span class="st">"""</span></span>
<span id="cb2-43"><a href="#cb2-43"></a>MAP_PROMPT <span class="op">=</span> PromptTemplate(template<span class="op">=</span>prompt_template, input_variables<span class="op">=</span>[<span class="st">"text"</span>])</span>
<span id="cb2-44"><a href="#cb2-44"></a>prompt_template <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb2-45"><a href="#cb2-45"></a><span class="st">Combine the following summaries into a GitHub-style README. Pay special attention to build process, importing, and and command line interactions that are possible. If there are important errors in the code or TODOs, extract them. Extract inidividual lines in code blocks if helpful.</span></span>
<span id="cb2-46"><a href="#cb2-46"></a></span>
<span id="cb2-47"><a href="#cb2-47"></a><span class="st">==PART SUMMARIES==</span></span>
<span id="cb2-48"><a href="#cb2-48"></a><span class="sc">{text}</span></span>
<span id="cb2-49"><a href="#cb2-49"></a></span>
<span id="cb2-50"><a href="#cb2-50"></a><span class="st">==README==</span></span>
<span id="cb2-51"><a href="#cb2-51"></a><span class="st">"""</span></span>
<span id="cb2-52"><a href="#cb2-52"></a>COMBINE_PROMPT <span class="op">=</span> PromptTemplate(template<span class="op">=</span>prompt_template, input_variables<span class="op">=</span>[<span class="st">"text"</span>])</span>
<span id="cb2-53"><a href="#cb2-53"></a></span>
<span id="cb2-54"><a href="#cb2-54"></a></span>
<span id="cb2-55"><a href="#cb2-55"></a><span class="co">## Prompts for Refine</span></span>
<span id="cb2-56"><a href="#cb2-56"></a></span>
<span id="cb2-57"><a href="#cb2-57"></a>prompt_template <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb2-58"><a href="#cb2-58"></a><span class="st">Write a GitHub-style README. Pay special attention to build process, importing, and and command line interactions that are possible. If there are important errors in the code or TODOs, extract them. Extract inidividual lines in code blocks if helpful.</span></span>
<span id="cb2-59"><a href="#cb2-59"></a></span>
<span id="cb2-60"><a href="#cb2-60"></a><span class="st">==CODE==</span></span>
<span id="cb2-61"><a href="#cb2-61"></a><span class="sc">{text}</span></span>
<span id="cb2-62"><a href="#cb2-62"></a></span>
<span id="cb2-63"><a href="#cb2-63"></a><span class="st">==README==</span></span>
<span id="cb2-64"><a href="#cb2-64"></a><span class="st">"""</span></span>
<span id="cb2-65"><a href="#cb2-65"></a>QUESTION_PROMPT <span class="op">=</span> PromptTemplate(template<span class="op">=</span>prompt_template, input_variables<span class="op">=</span>[<span class="st">"text"</span>])</span>
<span id="cb2-66"><a href="#cb2-66"></a>refine_prompt_tmpl <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb2-67"><a href="#cb2-67"></a><span class="st">Iteratively write a GitHub-style README. Pay special attention to build process, importing, and and command line interactions that are possible. The WIP README will be provided, as well as the next block of code to integrate into the README. Use best judgment to drop uninteresting parts of the README as it gets too long. If there is no new interesting information in the provided code, return the original WIP README. If there are important errors in the code or TODOs, extract them. Extract inidividual lines in code blocks if helpful.</span></span>
<span id="cb2-68"><a href="#cb2-68"></a></span>
<span id="cb2-69"><a href="#cb2-69"></a><span class="st">==WIP README==</span></span>
<span id="cb2-70"><a href="#cb2-70"></a><span class="sc">{existing_answer}</span></span>
<span id="cb2-71"><a href="#cb2-71"></a></span>
<span id="cb2-72"><a href="#cb2-72"></a><span class="st">==NEW SECTION==</span></span>
<span id="cb2-73"><a href="#cb2-73"></a><span class="sc">{text}</span></span>
<span id="cb2-74"><a href="#cb2-74"></a></span>
<span id="cb2-75"><a href="#cb2-75"></a><span class="st">==REFINED README==</span></span>
<span id="cb2-76"><a href="#cb2-76"></a><span class="st">"""</span></span>
<span id="cb2-77"><a href="#cb2-77"></a>REFINE_PROMPT <span class="op">=</span> PromptTemplate(</span>
<span id="cb2-78"><a href="#cb2-78"></a>    input_variables<span class="op">=</span>[<span class="st">"existing_answer"</span>, <span class="st">"text"</span>],</span>
<span id="cb2-79"><a href="#cb2-79"></a>    template<span class="op">=</span>refine_prompt_tmpl,</span>
<span id="cb2-80"><a href="#cb2-80"></a>)</span>
<span id="cb2-81"><a href="#cb2-81"></a></span>
<span id="cb2-82"><a href="#cb2-82"></a></span>
<span id="cb2-83"><a href="#cb2-83"></a><span class="co">## Prompts for Tree Summary</span></span>
<span id="cb2-84"><a href="#cb2-84"></a></span>
<span id="cb2-85"><a href="#cb2-85"></a>summary_template <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb2-86"><a href="#cb2-86"></a><span class="st">Explain the following code in English, including details that will be useful for later iterations to combine summaries, to inderstand the entire codebase. If there are important errors in the code or TODOs, extract them. Extract individual lines in code blocks if helpful. The summaries should be exhaustive.</span></span>
<span id="cb2-87"><a href="#cb2-87"></a></span>
<span id="cb2-88"><a href="#cb2-88"></a><span class="st">==CODE==</span></span>
<span id="cb2-89"><a href="#cb2-89"></a><span class="sc">{context_str}</span></span>
<span id="cb2-90"><a href="#cb2-90"></a></span>
<span id="cb2-91"><a href="#cb2-91"></a><span class="st">==COMPREHENSIVE SUMMARY==</span></span>
<span id="cb2-92"><a href="#cb2-92"></a><span class="st">"""</span></span>
<span id="cb2-93"><a href="#cb2-93"></a>SUMMARY_PROMPT <span class="op">=</span> SummaryPrompt(summary_template)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="map-reducerefine-methods" class="slide level2">
<h2>Map Reduce/Refine Methods</h2>

<img data-src="https://gpt-index.readthedocs.io/en/latest/_images/list_query.png" class="r-stretch"></section>
<section id="tree-index" class="slide level2">
<h2>Tree Index</h2>

<img data-src="https://gpt-index.readthedocs.io/en/latest/_images/tree.png" class="r-stretch"></section>
<section id="demo" class="slide level2">
<h2>Demo!</h2>
</section>
<section id="vector-db-todo" class="slide level2">
<h2>Vector DB (TODO)</h2>

<img data-src="https://gpt-index.readthedocs.io/en/latest/_images/vector_store_query.png" class="r-stretch"></section>
<section id="actually-clever-chunking-todo" class="slide level2 smaller">
<h2>Actually Clever Chunking (TODO)</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1"></a><span class="ex">get_encoding</span>     <span class="kw">|</span> <span class="kw">function</span><span class="fu">     def</span> <span class="kw">(</span><span class="ex">120,</span> 4<span class="kw">)</span> <span class="ex">-</span> <span class="er">(</span><span class="ex">120,</span> 16<span class="kw">)</span> <span class="kw">`</span><span class="ex">def</span> get_encoding<span class="er">(</span><span class="ex">model</span><span class="kw">)</span><span class="bu">:</span><span class="kw">`</span></span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="ex">get_encoding</span>     <span class="kw">|</span> <span class="ex">call</span>         ref <span class="er">(</span><span class="ex">82,</span> 19<span class="kw">)</span> <span class="ex">-</span> <span class="er">(</span><span class="ex">82,</span> 31<span class="kw">)</span> <span class="kw">`</span><span class="fu">size</span> = len<span class="er">(</span><span class="ex">get_encoding</span><span class="er">(</span><span class="ex">model</span><span class="kw">)</span><span class="ex">.encode</span><span class="er">(</span><span class="ex">text</span><span class="kw">))`</span></span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="ex">get_encoding</span>     <span class="kw">|</span> <span class="ex">call</span>         ref <span class="er">(</span><span class="ex">101,</span> 15<span class="kw">)</span> <span class="ex">-</span> <span class="er">(</span><span class="ex">101,</span> 27<span class="kw">)</span> <span class="kw">`</span><span class="ex">encoding</span> = get_encoding<span class="er">(</span><span class="ex">model</span><span class="kw">)`</span></span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="ex">get_encoding</span>     <span class="kw">|</span> <span class="ex">call</span>         ref <span class="er">(</span><span class="ex">124,</span> 28<span class="kw">)</span> <span class="ex">-</span> <span class="er">(</span><span class="ex">124,</span> 40<span class="kw">)</span> <span class="kw">`</span><span class="ex">encoding</span> = tiktoken.get_encoding<span class="er">(</span><span class="st">"gpt2"</span><span class="kw">)`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>I bring these up to give you an idea of what Microsoft is presumably doing– they developed this library, and they are integrating it with GPT4 in Copilot X.</p>
</section>
<section id="agency" class="slide level2 smaller">
<h2>Agency</h2>

<img data-src="./../_images/babyagi.png" class="r-stretch"></section>
<section id="section-5" class="slide level2">
<h2></h2>
<p>However! Even if Microsoft scoops us, with LLMs it’s still very useful to know how the underlying technology works.</p>
<p>But, talking about Microsoft:</p>
</section>
<section id="copilot-demo" class="slide level2">
<h2>Copilot Demo</h2>
</section>
<section id="bing-demo" class="slide level2">
<h2>Bing Demo</h2>
</section>
<section id="ttt-demo" class="slide level2">
<h2>TTT Demo</h2>
</section>
<section id="summary" class="slide level2">
<h2>Summary</h2>
<ul>
<li>local scripts for summarizing and understanding local repos</li>
<li>web-integrated tools for helping with research</li>
<li>IDE integrated tools for helping with coding</li>
</ul>
</section>
<section id="summary-1" class="slide level2">
<h2>Summary</h2>

<img data-src="../_images/karpathy.png" class="r-stretch"></section>
<section id="tai-calc" class="slide level2 smaller">
<h2>TAI Calc</h2>
<p>“But anyway something like 1e34 to 1e36 of 2022-compute seems like it could be enough to create TAI.<br>
<br>
Entertain that notion and make the following assumptions:<br>
<br>
- The price-performance of AI chips seems to double every 1.5 to 3.1 years (Hobbhahn and Besiroglu 2022); assume that that’ll keep going until 2030, after which the doubling time will double as Moore’s Law fails.<br>
- Algorithmic progress on ImageNet seems to effectively halve compute requirements every 4 to 25 months (Erdil and Besiroglu 2022); assume that the doubling time is 50% longer for transformers.<br>
- Spending on training runs for ML systems seems to roughly double every 6 to 10 months; assume that that’ll continue until we reach a maximum of $10B.<br>
<br>
What all that gives you is 50% probability of TAI by 2040, and 80% by 2045:”</p>
</section>
<section id="misc" class="slide level2 smaller">
<h2>Misc</h2>
<p>“We proposed an approach that allows natural language agents to learn from past mistakes and redirect future decisions in planning sequences which removes the human trainer in a human-in-the-middle approach.”<sup>1</sup></p>

<div class="footer footer-default">

</div>
<aside><ol class="aside-footnotes"><li id="fn3"><p><a href="https://arxiv.org/pdf/2303.11366.pdf">Reflexion: an autonomous agent with dynamic memory and self-reflection</a></p></li></ol></aside></section>

    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        target: function(trigger) {
          return trigger.previousElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto-reveal',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>