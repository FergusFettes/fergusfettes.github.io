<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>metronome – Fergus Fettes</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-e26003cea8cd680ca0c55a263523d882.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-e73ed75cf5e7a3fd855296a79e6d84f7.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Fergus Fettes</span>
    </a>
  </div>
          <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          <div class="quarto-navbar-tools">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
            <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#metronomes-in-human-experience" id="toc-metronomes-in-human-experience" class="nav-link active" data-scroll-target="#metronomes-in-human-experience">Metronomes in Human Experience</a>
  <ul class="collapse">
  <li><a href="#the-year" id="toc-the-year" class="nav-link" data-scroll-target="#the-year">The Year</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block"></header>




<section id="metronomes-in-human-experience" class="level1">
<h1>Metronomes in Human Experience</h1>
<p>What defines the present moment &amp; characterises our passage through it? Not the ticking of the clock surely. But in a world defined by <a href="../Essays/Flux.html">constant change</a> how does any creature great or small differentiate one moment from the next, seperating out parcels from undifferentiated duration.</p>
<p>Metronomes help. The beat of a drum, the beat of my heart, the great throw of the ocean on the shore. The day, rolling across us again &amp; again.</p>
<p>What are our most familiar metronomes &amp; how do they situate us?</p>
<section id="the-year" class="level2">
<h2 class="anchored" data-anchor-id="the-year">The Year</h2>
<blockquote class="blockquote">
<p>Top notes: spring flowers &amp; breeding, autumn leaves<br>
Heart notes: summer sun, winter snow<br>
Bass notes: the steady motion of the stars, the equinoxes</p>
</blockquote>
<p>An age unto itself! No doubt the longest time that many animals learn to experience. And perhaps a late arriveal to evolutionary history, the tear grows louder as we climb ashore &amp; start to brave the North &amp; South. A late arrival to human history as well, our begginnings in the tropics no doubt sheltered us from its worst extremes. Outside the tropics the year reinforces the lessons of the day: binary states, temperature extremes, oscillating back &amp; forth. And the two halves of the year characterized by one kind of change or another– waxing &amp; waning of seasons. The our corners of the year &amp; the four seasons are no anthropomorphic imposition– they are placed at the two extremes, the solstices &amp; at the two moments of fastest change, the equinoxes.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./../_images/solstices.png" class="img-fluid figure-img"></p>
<figcaption>Solstices &amp; Equinoxes</figcaption>
</figure>
</div>
<p>But this is everywhere apparent– because if humans had invented the year, how did nature learn to dress itself in such different fashions? Not by copying our flamboyant displays I’m sure.</p>
<blockquote class="blockquote">
<p>Top notes: lunar flowers, lunar insects, lunar corals<br>
Heart notes: the visual spectacle, braving the day &amp; disrupting night<br>
Base notes: the great blanket of the ocean rising &amp; falling in a double lockstep with little luna</p>
</blockquote>
<p>The year has a quiet little cousin, Luna. It bridges the great expanse between year &amp; day. Despite being gentler in its influence it mimics the four states, bright &amp; dark, waxing &amp; waning. It fits twelve times in the year &amp; thereby teaches us a great &amp; elegant number. And there are three fours in twelve! What signifance has that, do you suppose?</p>
<p>The pasasage of the moon is quite subtle, but despite its lack of fire we feel its influence upon us, warping &amp; dividing the day into tides, bringing light into the night– a divine &amp; mysterious imposition! And the keen &amp; sensitive eye will see its followers everywhere about– in poor moon-addled moths or menstrual cycles.</p>
<p>And then comes the day. Ah the day! It is impossible to imagine a more perfect span of time. Enough to dream &amp; dance &amp; eat &amp; talk &amp; dream again! What a difference a day makes. In a day you can plan a whole adventure, a feast, a ball– &amp; carry it out as well, bring it all to fruition, gather friends &amp; family &amp; strangers for some great undertaking, some great experience! And then– perhaps by luna’s light– to bed to dream &amp; ready yourself for another. And another &amp; another! Thirty times, almost, until the moon shows the same face– many hundreds– who really knows how many– many hundreds of days until the same flowers will return, the same birds will tell you– &amp; then again &amp; again &amp; again &amp; again, by their hundreds &amp; their thousands they march by. Uncountably many, an inconcievable array, &amp; each one perfect &amp; complete, bracketed vby night, lit by the one true God, that unfailing fire-bringer, life-bringer, feeder of plants of warmer of skin &amp; breath!</p>
<p>What a thing is a day. What a marvellous thing.</p>
<p>And it to has its waxing &amp; its waning, dusk &amp; dawn– those still incomparable beauties, those beauties that define beauty, against which all beauty tries &amp; fails.</p>
<blockquote class="blockquote">
<p>Top notes: all life, responsive &amp; reactive &amp; aware<br>
Heart notes: the sun the clouds the sky<br>
Bass notes: circadian rhythms, the deep subconscious pulse</p>
</blockquote>
<p>What else on that scale? What other rhythms direct us? The stars precede over thousands of years, a slow drift that modulates the sky. The wandering stars &amp; comets go their way. Meteorites periodically light up the sky &amp; earthquakes &amp; hurricanes come &amp; disturb our days from time to time.</p>
<p>But nothing has the beat of those three. They divide up our long durations &amp; determine all our festivals &amp; all the narrative waypoints of life.</p>
<p>The next steady beat is in some way quieter &amp; much more personal than those. It is the heartbeat.</p>
<p>Dimly overheard but everpresent. Everpresent. That most marvellous muscle sends pressure waves out to your furthest extremeties. Your body doesn’t so much as ‘know’ the heartbeat– it is the foundation of all things. New oxygen comes with a rhythm. Your muscles incorporate it into every deed. Your brain swells &amp; shrinks in your skull– do you feel your thoughts quicken &amp; slow with a rhythm? Perhaps?</p>
<p>The heartbeat is no ‘universal’– as if anything is– but considering your little universe it nearly is. Do your thoughts race in time with your heart? Does the world not speed up &amp; race ahead of you when you relax &amp; let it slow?</p>
<blockquote class="blockquote">
<p>Top notes: the electric tingle in all your cells, mere existence<br>
Heart notes: the drum of your emotional world, your excitement, your fatigue– manifest!<br>
Bass notes: time itself</p>
</blockquote>
<p>The heartbeat defines the pace of time for everything that has it. Could the day be like a heartbeat for a plant? Such speculations are beyond us for now. But pulse-driven creatures like ourselves– you can tell to look at them, if you tried to guess. Pick your nearest animal, look deep in its eyes, look at its gestures &amp; motions &amp; suppose to yourself what its heartbeat might be, what pace it sees the world at. I guarantee you wot be far off.</p>
<p>There are other bodily rhythms. The stages of development of a body, the menstrual cycle, the period of generations. There are characteristic speeds of twitching, there are brain waves. There is breathing! There is pacing &amp; running! (Breathing– a strange cycle. So forceful on its own &amp; yet nearly within our control! That relationship is a novel to itself.) But this is not a catalogue. I have my players, three big, one small. There are many bit-parts &amp; side characters in this drama– what is the world but a whorl within a whorl, a set of stacked cycles reaching from mere matter out to heaven?</p>
<p>There. We have time. Time enough. We feel ourselves driven onwards by these tiny parcels, normally just at the dge of hearing but rising up in times of drama to a hammering. We wake &amp; see the world, &amp; are reminded in the course of the day of the passage of the month &amp; the year. And if we think of summers or of springs– we can count them somehow, &amp; we are told there are so-and-so many, no more, no less. Or rather less as the case may be but certainly no more.</p>
<p>Is that not enough? Do we lack somehow for stepping stones on our journey from place to place &amp; to the grave? It can be, it really can &amp; often is. But we miss the should &amp; we are curious creatures &amp; life will insist on presenting us with mysteries &amp; puzzles. Why 4 seasons, not three? Why 12 months, not 9 or 15? Nature makes work for idle hands &amp; after the age of agriculture began &amp; slaves &amp; beurocracy began their millenia of toil idle hands had time to work.</p>
<p>Our metronomes teach us about numbers. Day &amp; night, sun &amp; moon, self &amp; other. Splitting collections– four seasons, four phases of the moon. It is no step at all from there to fractions. Ten fingers to count with so count everything by tens. But why 12? It is a mystery &amp; nature will leave them everywhere. It divides into three &amp; four– two good, honest numbers, numbers <a href="https://en.wikipedia.org/wiki/Subitizing">even birds can see</a>. Is that explanation enough? Is there something sacred about the act of multiplication itself perhaps? Two by two by three– that is, two sixes, is also twelve.</p>
<blockquote class="blockquote">
<p><span class="math inline">\(6\cdot10\cdot6\cdot10\cdot2\cdot12\)</span><br>
<span class="math inline">\(2\cdot3\cdot2\cdot5\cdot2\cdot3\cdot2\cdot5\cdot2\cdot2\cdot2\cdot3\)</span><br>
<span class="math inline">\(2^7\cdot3^3\cdot5^2\)</span></p>
</blockquote>
<p>I don’t now how the scaffolding came about. With twelve echoing in their heads they split the day &amp; night into twelve pieces each. When they noticed those twelve pieces, divided again by twelve &amp; once again. No.&nbsp;I have lost my faith.</p>
<p>Believing that the second is a mechanical mirror of the heartbeat I hoped to understand how they factored the day. But <span class="math inline">\(4\cdot12^4\)</span> would have our seconds at 0.96 as long as they are– isn’t that just as good, &amp; more beautiful?</p>
<p>Did they really fall in love with 60 first? 60 of all the numbers, 6x10<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>? Is history so contingent, so littered with the artefacts of ancient compromises that we are left with <span class="math inline">\(2^7\cdot3^3\cdot5^2\)</span> heartbeats in a day, a system imposed almost universally?</p>
<p>[In quickscript: And history is slow &amp; indolent &amp; sticky.]</p>
<p>Well. The best laid plans of. I had hoped at this point in the essay to have understood in a flash of brilliance how the beating of the heart had been built into the foundation of all our everyday activities. But after all the Herz is not the unit of the heart– that’s just a visual pun, another silly accident built into all our endeavours. It is named after a man, a family name.</p>
<p>In any case it is near enough &amp; perhaps there are worse compromises to suffer. The ticking of the clock, that mechanical convenience used to regulate experience, beats with the rhythm of a heart– not <em>the</em> heart mind you, for there is no such thing– but a heart, a common human heart, a heart at rest &amp; at ease with the world, a heart under no duress, no exceptional sickness or stress. A common heart, a heart that most everyone has had for moments, for a beat or two between the quickenings &amp; slowings of our ever-changing duration.</p>
<p>And no doubt it is for the best &amp; might even give us hope that we resist the urge to throw away the oddities we carry with us. Some little quirks of ages past embedded in our lives. The inexplicable way some ancient scribes collected sacred numbers out of nature &amp; assembled them into a scaffolding out of which to build an artific of shared duration.</p>
<p>Our letters carry marks of many minds. Why not our moments too?</p>


</section>
</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Or 5x12– then you can <a href="https://en.wikipedia.org/wiki/Duodecimal#Origin">count by twelve on one hand, &amp; five on the other</a>. Nevertheless.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p><a href="https://www.quarto.org">Quarto</a></p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/FergusFettes">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>